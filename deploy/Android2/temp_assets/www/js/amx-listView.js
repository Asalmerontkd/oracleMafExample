(function(){function b(a){return new adf.mf.internal.BasePromise(function(b,c){a.classList.remove("amx-listItem-undisclosed");var d=a.style.height,e=a.style.minHeight,g=a.offsetHeight;a.style.height="0";a.style.minHeight="0";a.classList.add("amx-animating");adf.shared.impl.animationUtils._requestAnimationFrame(function(){a.classList.add("amx-listItem-disclosing");a.style.height=g-1+"px";a.style.minHeight=g-1+"px";adf.shared.impl.animationUtils.addOneTimeTransitionEndWithFailsafe(a,function(){a.classList.remove("amx-listItem-disclosing");
a.style.height=d;a.style.minHeight=e;a.classList.remove("amx-animating");b()})})})}function c(a){return new adf.mf.internal.BasePromise(function(b,c){var d=a.style.height,e=a.style.minHeight,g=a.offsetHeight;a.style.height=g-1+"px";a.style.minHeight=g-1+"px";a.classList.add("amx-animating");adf.shared.impl.animationUtils._requestAnimationFrame(function(){a.classList.add("amx-listItem-undisclosing");a.style.height="0";a.style.minHeight="0";adf.shared.impl.animationUtils.addOneTimeTransitionEndWithFailsafe(a,
function(){a.classList.remove("amx-listItem-undisclosing");a.classList.add("amx-listItem-undisclosed");a.style.height=d;a.style.minHeight=e;a.classList.remove("amx-animating");b()})})})}function a(a,b,c,d){if(!b.isTreeNodeIterator()){var e={};b=b.getRowKey().toString().replace("'","\\'");e[c]=d.appendIndex(b);a.__pushElReplacements(e)}}function e(a,b){b.isTreeNodeIterator()||a.__popElReplacements()}function d(a,b,c){var d=a.getVolatileState();void 0===d&&(d={},a.setVolatileState(d));d[b]=c}function g(a){if(null==
a)return a;if("string"===typeof a||a instanceof String)a=-1<a.indexOf(",")?a.split(","):-1<a.indexOf(" ")?a.split(" "):[a];else if("number"===typeof a||a instanceof Number)a=[a];return a}function h(a,b){var c=b.getAttributeExpression("selectedRowKeys");b.setAttributeResolvedValue("_selectedRowKey",a);void 0===c||null==c?d(b,"selectedRowKey",a):adf.mf.api.amx.getPageRootNode().visit(new adf.mf.api.amx.VisitContext({amxNodes:[b]}),function(b,d){adf.mf.el.setValue({name:c,value:[a]},function(){},null);
return adf.mf.api.amx.VisitResult.COMPLETE})}function k(a){var b=a.getAttributeExpression("selectedRowKeys");if(void 0===b||null==b){if(a=a.getVolatileState(),null!=a)return a=a.selectedRowKey,void 0===a?null:a}else if(a=g(adf.mf.el.getLocalValue(b)),null!=a)return a[0];return null}function m(a,b){null!=a.getTag().getAttribute("selectionListener")&&(b.classList.add("amx-listItem-selected"),b.setAttribute("aria-selected",!0))}function n(a){a.classList.remove("amx-listItem-selected");a.setAttribute("aria-selected",
!1)}function t(a,b){for(var c=a.childNodes,d=c.length,e=b.length,g=[],h=0,k=0;k<d&&h<e;++k)for(var m=c[k],n=0;n<e;++n)if(m.classList.contains(b[n])){g[n]=m;++h;break}return g}function u(a){var b=null,c=null,d=null,e=null,g=null,h=t(a,["amx-listItem-handle"])[0];null!=h&&adf.mf.api.amx.addDragListener(h,{start:function(h,k){k.requestDragLock(this,!0,!0);d=c=void 0;e=a.offsetHeight;g=a.parentNode.scrollHeight+1+e/2;var m=adf.mf.internal.amx._getNonPrimitiveElementData(a,"amxNode");null!=m&&(c=m.getStampKey());
a.classList.add("move");b=document.createElement("div");b.className="amx-listItem amx-listItem-drop-spacer";z(a.parentNode,a,b)},drag:function(c,d){c.preventDefault();c.stopPropagation();d.preventDefault=!0;d.stopPropagation=!0;var h=adf.mf.internal.amx.getElementTop(a),k=d.pageY,m=h+d.deltaPageY,h=a.parentNode,n=adf.mf.internal.amx.getElementTop(h);m<n&&(m=n);m<=n+5?(h.setAttribute("data-stop",!1),x(h,-1)):m+e>=n+h.offsetHeight-5?(h.setAttribute("data-stop",!1),x(h,1)):h.setAttribute("data-stop",
!0);m=e/2;k=Math.min(g,k-m-n+h.scrollTop);a.style.top=k+"px";h.classList.add("notSelect");for(var t=h.childNodes,k=[],n=0,u=t.length;n<u;++n){var w=t[n];!w.classList.contains("amx-listItem")||w.classList.contains("amx-listItem-drop-spacer")||w.classList.contains("move")||w.classList.contains("amx-listItem-moreRows")||k.push(w)}n=0;for(t=k.length;n<t;++n){var u=k[n],w=u.offsetTop,v=u.offsetHeight,y=a.offsetTop+m;if(w<=y&&y<=w+v){y<=w+v/2?h.insertBefore(b,u):z(h,u,b);break}}},end:function(e,g){var h=
a.cloneNode(!0),k=a.parentNode;k.appendChild(h);a.style.display="none";var m=b.nextSibling;null!=m&&(m=adf.mf.internal.amx._getNonPrimitiveElementData(m,"amxNode"),null!=m&&(d=m.getStampKey()));m=h.offsetHeight;v(h,{opacity:0,height:0},function(){adf.mf.api.amx.removeDomNode(h);z(k,b,a);a.style.display="";a.classList.remove("move");a.style.top="";adf.mf.api.amx.removeDomNode(b)});v(b,{height:m+"px"});k.classList.remove("notSelect");k.setAttribute("data-stop",!0);if("undefined"!==typeof c){var m=new adf.mf.internal.amx.MoveEvent(c,
d),n=w(a);null!=n&&(n=adf.mf.internal.amx._getNonPrimitiveElementData(n,"amxNode"),adf.mf.api.amx.processAmxEvent(n,"move",void 0,void 0,m))}}})}function v(a,b,c){adf.shared.impl.animationUtils._requestAnimationFrame(function(){var d=adf.shared.impl.animationUtils._getBrowserSpecificName("transition"),e=a.style;b.hasOwnProperty("height")&&(e.height=a.offsetHeight+"px",e.minHeight=0,e.overflow="hidden");e[d]="all .4s ease-in-out";adf.shared.impl.animationUtils._requestAnimationFrame(function(){for(var d in b)e[d]=
b[d];c&&adf.shared.impl.animationUtils.addOneTimeTransitionEndWithFailsafe(a,c)})})}function w(a){if(a)for(a=a.parentNode;null!=a;){if(a.classList&&a.classList.contains("amx-listView"))return a;a=a.parentNode}}function x(a,b){b=1==b?1:-1;var c=adf.mf.api.amx.isValueTrue(a.getAttribute("data-stop"));a.scrollTop+=5*b;c||setTimeout(function(){x(a,b)},300)}function z(a,b,c){b=b.nextSibling;null==b?a.appendChild(c):a.insertBefore(c,b)}function y(a){for(var b=0,c=["webkit","ms","moz","o"],d=0;d<c.length&&
!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[c[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[d]+"CancelAnimationFrame"]||window[c[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var c=(new Date).getTime(),d=Math.max(0,16-(c-b)),e=window.setTimeout(function(){a(c+d)},d);b=c+d;return e});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});window.requestAnimationFrame(a)}
var A=adf.mf.api.amx.TypeHandler.register(adf.mf.api.amx.AmxTag.NAMESPACE_AMX,"listView");A.prototype.createChildrenNodes=function(b){b.setAttributeResolvedValue("_selectedRowKey",k(b));if(!b.isAttributeDefined("value"))return!1;var c;if(adf.mf.environment.profile.dtMode)c=[{},{},{}],b.setAttributeResolvedValue("value",c);else{c=b.getAttribute("value");if(void 0===c)return b.setState(adf.mf.api.amx.AmxNodeStates.ABLE_TO_RENDER),b.setAttributeResolvedValue("_placeholder","yes"),adf.mf.api.amx.AmxNodeCreateChildrenNodesResult.DEFERRED;
if(null==c)return!0}var d=Infinity,g=null,h=b.getAttribute("fetchSize");null!=h&&adf.mf.internal.amx.isFiniteNumber(parseInt(h,10))&&(d=parseInt(h,10),0>d?d=Infinity:0==d&&(d=25));b.setAttributeResolvedValue("fetchSize",d);var h=adf.mf.api.amx.createIterator(c),m=b.getClientState();null!=m&&(g=m.maxRows,null!=g&&b.setAttributeResolvedValue("maxRows",g));null==g&&(0==b.isAttributeDefined("maxRows")?(g=d,b.setAttributeResolvedValue("maxRows",d)):(g=parseInt(b.getAttribute("maxRows"),10),isNaN(g)&&(g=
d,b.setAttributeResolvedValue("maxRows",d))));b.setAttributeResolvedValue("_oldMaxRows",g);if(h.getTotalCount()>h.getAvailableCount()&&h.getAvailableCount()<g)return adf.mf.api.amx.showLoadingIndicator(),adf.mf.api.amx.bulkLoadProviders(c,0,g,function(){try{var a=new adf.mf.api.amx.AmxNodeUpdateArguments;a.setAffectedAttribute(b,"value");a.setAffectedAttribute(b,"_bulkLoad");adf.mf.api.amx.markNodeForUpdate(a)}finally{adf.mf.api.amx.hideLoadingIndicator()}},function(a,b){adf.mf.api.adf.logInfoResource("AMXInfoBundle",
adf.mf.log.level.SEVERE,"amx:listView.createChildrenNodes","MSG_ITERATOR_FIRST_NEXT_ERROR");adf.mf.log.Framework.isLoggable(adf.mf.log.level.FINE)&&adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"amx:listView","createChildrenNodes","Request: "+a+" response: "+b);adf.mf.api.amx.hideLoadingIndicator()}),b.setState(adf.mf.api.amx.AmxNodeStates.ABLE_TO_RENDER),b.setAttributeResolvedValue("_placeholder","yes"),adf.mf.api.amx.AmxNodeCreateChildrenNodesResult.DEFERRED;b.setAttributeResolvedValue("_placeholder",
"nomore");b.createStampedChildren(null,["header","footer"]);c=b.getAttribute("var");d=b.getAttributeExpression("value",!1,!0);for(m=0;m<g&&h.hasNext();++m){var n=h.next(),t=b.createStampedChildren(h.getRowKey(),[null]);adf.mf.el.pushVariable(c,n);try{a(b,h,c,d),this._evaluateDividerAttribute(b,t[0])}finally{adf.mf.el.popVariable(c),e(b,h)}}b.setAttributeResolvedValue("_rowCount",h.getCurrentIndex()+1);b.setState(adf.mf.api.amx.AmxNodeStates.ABLE_TO_RENDER);return!0};A.prototype.attributeChangeResult=
function(a,b,c){switch(b){case "dividerAttribute":case "dividerMode":return adf.mf.api.amx.AmxNodeChangeResult.REPLACE;case "value":return b=c.getCollectionChange("value"),c.hasChanged("_bulkLoad")||null!=b&&b.isItemized()?this._updateChildrenForCollectionChange(a,c,b):adf.mf.api.amx.AmxNodeChangeResult.REPLACE;case "_bulkLoad":return adf.mf.api.amx.AmxNodeChangeResult.NONE;case "maxRows":return this._updateChildrenForCollectionChange(a,c,c.getCollectionChange("value"));case "showMoreStrategy":return adf.mf.api.amx.AmxNodeChangeResult.REFRESH;
case "editMode":return a=a.getAttribute("editMode"),c=c.getOldValue("editMode"),a==c?adf.mf.api.amx.AmxNodeChangeResult.NONE:adf.mf.api.amx.isValueTrue(a)?adf.mf.api.amx.AmxNodeChangeResult.REFRESH:adf.mf.api.amx.AmxNodeChangeResult.RERENDER;case "selectedRowKeys":return a.setAttributeResolvedValue("_selectedRowKey",k(a)),adf.mf.api.amx.AmxNodeChangeResult.REFRESH;default:return A.superclass.attributeChangeResult.call(this,a,b,c)}};A.prototype.visitChildren=function(b,c,d){var g=b.getAttribute("value");
if(void 0===g)return b.visitStampedChildren(null,null,null,c,d);if(b.visitStampedChildren(null,["header","footer"],null,c,d))return!0;for(var g=adf.mf.api.amx.createIterator(g),h=b.getAttribute("var"),k=b.getAttributeExpression("value",!1,!0);g.hasNext();){var m=g.next();adf.mf.el.pushVariable(h,m);try{if(a(b,g,h,k),b.visitStampedChildren(g.getRowKey(),[null],null,c,d))return!0}finally{e(b,g),adf.mf.el.popVariable(h)}}return!1};A.prototype.render=function(a,b){var c=document.createElement("div");
c.className="amx-listView";"cards"!=a.getAttribute("layout")||adf.mf.api.amx.isValueTrue(a.getAttribute("editMode"))?c.classList.add("amx-listView-rows"):c.classList.add("amx-listView-cards");if("yes"==a.getAttribute("_placeholder")){var d=document.createElement("div");d.id=b+"_placeholder";d.className="amx-listView-placeholder amx-deferred-loading";var e=adf.mf.resource.getInfoString("AMXInfoBundle","MSG_LOADING");d.setAttribute("aria-label",e);c.appendChild(d);a.setState(adf.mf.api.amx.AmxNodeStates.PARTIALLY_RENDERED);
return c}this._renderHeaderFacet(a,c);var g=document.createElement("div");c.appendChild(g);g.className="amx-listView-main";d=document.createElement("div");g.appendChild(d);d.id=b+"_innerList";d.className="amx-listView-innerList";switch(a.getAttribute("halign")){case "start":d.style.textAlign="rtl"==document.documentElement.dir?"right":"left";break;case "end":d.style.textAlign="rtl"==document.documentElement.dir?"left":"right";break;case "center":d.style.textAlign="center";break;case "left":d.style.textAlign=
"left";break;case "right":d.style.textAlign="right"}adf.mf.api.amx.enableScrolling(d);var h=a.getAttribute("_selectedRowKey"),e=a.getAttribute("maxRows"),k=a.getAttribute("dividerAttribute");null!=k&&""!=k?"off"!==a.getAttribute("sectionIndex")&&"firstLetter"===a.getAttribute("dividerMode")&&(a.setAttributeResolvedValue("_indexBarRegister",{}),k=document.createElement("div"),k.className="amx-listView-index",g.appendChild(k)):(d.classList.add("amx-listView-content"),g=a.getAttribute("contentStyle"),
null!=g&&(k=d.getAttribute("style"),null!=k&&""!=k?d.setAttribute("style",k+";"+g):d.setAttribute("style",g)));g=a.getAttribute("value");k=!1;if(void 0!==g){for(var h=adf.mf.api.amx.createIterator(g),n=k=null,g=0;g<e&&h.hasNext();++g){h.next();var t=a.getRenderedChildren(null,h.getRowKey());0<t.length&&(t=t[0],n=this._renderStampedItem(!1,a,d,t,k,n),k=t)}k=h.getTotalCount()>e||!h.isAllDataLoaded();adf.mf.api.amx.isValueTrue(a.getAttribute("showDividerCount"))&&null!=a.getAttribute("_dividerAttrEl")&&
this._displayDividerCount(d);adf.mf.api.amx.isValueTrue(a.getAttribute("editMode"))&&d.classList.add("amx-listView-editMode")}else for(e=a.renderDescendants(),g=0,n=e.length;g<n;++g){var t=e[g],u=""+g;h==u&&m(a,t);t.setAttribute("data-listViewRk",u);d.appendChild(t)}this._addOrRemoveLoadMoreRowsDom(a,b,d,k,!0);this._appendFooter(a,c);return c};A.prototype.init=function(a,b){var c=a.querySelector(".amx-listView-innerList");this._createScrollHandler(b,c,a)};A.prototype.__getTestJavaScriptURI=function(a){return"js/testing/amx-listView.js"};
A.prototype._evaluateDividerAttribute=function(a,b){var c=a.getAttribute("dividerAttribute");if(null!=c&&""!=c){var d=a.getAttribute("_dividerAttrEl");null==d&&(d="#{"+a.getAttribute("var")+"."+c+"}",a.setAttributeResolvedValue("_dividerAttrEl",d));c=this._getCurrentDivider(a,d);b.setAttributeResolvedValue("_dividerValue",c)}};A.prototype._endLoadMoreRows=function(a){var b=a.getAttribute("_loadMoreRowsPerf");if(null!=b){var c=a.getAttribute("_loadMoreRowsPerfTimeout");a.setAttributeResolvedValue("_loadMoreRowsPerf",
null);a.setAttributeResolvedValue("_loadMoreRowsPerfTimeout",null);null!=c&&window.clearTimeout(c);b.stop()}};A.prototype._createChildForKey=function(a,b,c,d){c.setCurrentRowKey(b);return c.getCurrentIndex()<d&&(created=a.createStampedChildren(b,[null]),1==created.length)?(this._evaluateDividerAttribute(a,created[0]),!0):!1};A.prototype._updateChildrenForCollectionChange=function(b,c,d){var g=b.getAttribute("value");if(void 0===g)return adf.mf.api.amx.AmxNodeChangeResult.REPLACE;var h=!1,k={created:{},
removed:[],updated:[],rowsAdded:!1};c.setCustomValue("amxNodeCollectionChanges",k);c=b.getAttribute("_rowCount");var m=b.getAttribute("maxRows"),n,t,u,w,v,y=adf.mf.api.amx.createIterator(g),x=b.getAttribute("var"),A=b.getAttributeExpression("value",!1,!0);if(null!=d){var z=d.getDirtiedKeys();if(0<z.length){var C=[];n=0;for(D=z.length;n<D;++n){var B=z[n];y.setCurrentRowKey(B);y.getCurrentIndex()<m&&C.push(B)}if(0<C.length){var D=C.length,I=0,K=!1;for(n=0;n<D;++n)g.setCurrentRowKey(C[n]),g.nextSet(function(){if(!K&&
++I==D){var a=new adf.mf.api.amx.AmxNodeUpdateArguments;a.setAffectedAttribute(b,"value");var c=new adf.mf.api.amx.AmxCollectionChange({itemized:!0,updated:C});a.setCollectionChanges(b.getId(),"value",c);adf.mf.api.amx.markNodeForUpdate(a)}},function(){K=!0})}}var z=d.getUpdatedKeys(),B=d.getCreatedKeys(),ba=d.getDeletedKeys();if(0<B.length||0<z.length||0<ba.length){n=0;for(d=ba.length;n<d;++n)if(t=b.removeChildrenByKey(ba[n]),0<t.length)for(--c,h=!0,w=0,u=t.length;w<u;++w)k.removed.push(t[w].getId());
n=0;for(d=z.length;n<d;++n)if(t=z[n],y.setCurrentRowKey(t)){adf.mf.el.pushVariable(x,y.getCurrent());try{a(b,y,x,A);var aa=b.getChildren(null,t).slice();w=0;for(u=aa.length;w<u;++w){b.removeChild(aa[w]);v=b.createStampedChildren(t,[null]);if(1!=v.length)return adf.mf.api.amx.AmxNodeChangeResult.REPLACE;this._evaluateDividerAttribute(b,v[0])}}finally{adf.mf.el.popVariable(x),e(b,y)}k.updated.push(t)}n=0;for(d=B.length;n<d;++n)if(t=B[n],y.setCurrentRowKey(t),y.getCurrentIndex()<m&&0==b.getChildren(null,
t).length){adf.mf.el.pushVariable(x,y.getCurrent());try{if(a(b,y,x,A),this._createChildForKey(b,t,y,m))++c,h=!0,k.created[t]=!0,k.rowsAdded=!0;else return adf.mf.api.amx.AmxNodeChangeResult.REPLACE}finally{adf.mf.el.popVariable(x),e(b,y)}}if(c>m){for(y.setCurrentIndex(m-1);c>m&&y.hasNext();)if(y.next(),t=y.getRowKey(),t=b.removeChildrenByKey(t),0<t.length)for(--c,h=!0,w=0,u=t.length;w<u;++w)k.removed.push(t[w].getId());if(c>m)return adf.mf.api.amx.AmxNodeChangeResult.REPLACE}}}if(c<m&&y.getTotalCount()>
c){y.setCurrentIndex(c-1);for(n=c;n<m&&y.hasNext();++n){u=y.next();t=y.getRowKey();adf.mf.el.pushVariable(x,u);try{if(a(b,y,x,A),this._createChildForKey(b,t,y,m))++c,h=!0,k.created[t]=!0,k.rowsAdded=!0;else return adf.mf.api.amx.AmxNodeChangeResult.REPLACE}finally{adf.mf.el.popVariable(x),e(b,y)}}y.getTotalCount()>y.getAvailableCount()&&y.getAvailableCount()<m&&(adf.mf.api.amx.showLoadingIndicator(),adf.mf.api.amx.bulkLoadProviders(g,0,m,function(){try{var a=new adf.mf.api.amx.AmxNodeUpdateArguments;
a.setAffectedAttribute(b,"value");a.setAffectedAttribute(b,"_bulkLoad");adf.mf.api.amx.markNodeForUpdate(a)}finally{adf.mf.api.amx.hideLoadingIndicator()}},function(a,b){adf.mf.log.logInfoResource("AMXInfoBundle",adf.mf.log.level.SEVERE,"amx:listView.createChildrenNodes","MSG_ITERATOR_FIRST_NEXT_ERROR");adf.mf.log.Framework.isLoggable(adf.mf.log.level.FINE)&&adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"amx:listView","createChildrenNodes","Request: "+a+" response: "+b);adf.mf.api.amx.hideLoadingIndicator()}))}h&&
b.setAttributeResolvedValue("_rowCount",c);return adf.mf.api.amx.AmxNodeChangeResult.REFRESH};A.prototype._createScrollHandler=function(a,b,c){var d=!1,e=a.getAttribute("showMoreStrategy");if("autoScroll"==e||"forceScroll"==e)d=!0;var g=!1;"viewport"==a.getAttribute("bufferStrategy")&&(g=!0);adf.mf.api.amx.removeBubbleEventListener(b,"scroll");var h=a.getAttribute("_useSticky"),h=!1;if(!0===h||d||g||c.classList.contains("amx-listView-hasScrollClientListener")){var k=function(a){var b=a.data[0],c=
a.data[1],e=b.getId(),k=a.target;if(k&&k.id==e+"_innerList"){var m=k.offsetHeight;if(null!=m&&0!=m){m=k.classList.contains("amx-listView-editMode");if(!m&&!0===h)for(var n=k.childNodes,t=0;t<n.length;t++){var u=n[t],w=u.childNodes[0],v=u.offsetTop,x=u.offsetHeight,A=w.offsetHeight,G=k.scrollTop;v<=G&&G<=v+x-A?u.classList.contains("amx-static")||u.classList.add("amx-static"):u.classList.contains("amx-static")&&u.classList.remove("amx-static");G>v+x-A?(w.classList.contains("amx-bottom")||w.classList.add("amx-bottom"),
w.style.opacity=Math.max(1-(G-v-x+A)/A,.5)):w.classList.contains("amx-bottom")&&(w.classList.remove("amx-bottom"),w.style.opacity=1)}!m&&d&&(m=document.getElementById(e+"_loadMoreRows"),null!=m&&k.scrollHeight!=k.offsetHeight&&(m.classList.contains("amx-listItem-scrollStrategy")||m.classList.add("amx-listItem-scrollStrategy"),n=0,"cards"!=b.getAttribute("layout")||adf.mf.api.amx.isValueTrue(b.getAttribute("editMode"))||(t=k.querySelectorAll(".amx-listItem.amx-node:last-child"),null!=t&&(u=t.length,
0==u&&(t=k.querySelectorAll(".amx-listItem.amx-node")),null!=t&&(u=t.length,1<u&&(n=t[u-1].offsetHeight)))),k.scrollTop>k.scrollHeight-k.offsetHeight-m.offsetHeight-n&&!m.classList.contains("amx-listItem-scrollStrategyLoading")&&(m.classList.add("amx-listItem-scrollStrategyLoading"),y(function(){b.getTypeHandler()._handleMoreRowsAction(b)}))));g&&c._updateViewportBuffer(b,k);document.getElementById(e).classList.contains("amx-listView-hasScrollClientListener")&&(a=new adf.mf.api.amx.DomEvent(e,"scroll",
a),adf.mf.api.amx.processAmxEvent(b,"scroll",void 0,void 0,a,function(){}))}}};adf.mf.api.amx.addBubbleEventListener(b,"scroll",k,[a,this]);var m=this;y(function(){k({target:b,data:[a,m]})})}};A.prototype._updateViewportBuffer=function(a,b){var c=parseInt(a.getAttribute("bufferSize"),10);if(isNaN(c)||0>c)c=100;for(var d=Math.max(0,b.scrollTop),e=b.offsetHeight,d=Math.min(d,b.scrollHeight-e),g=b.childNodes,h=d-c,c=d+e+c,d={outsideViewport:[],insideViewport:[]},e=0,k=g.length;e<k;++e){var m=g[e];if(!m.classList.contains("amx-listItem-moreRows"))if(m.classList.contains("amx-listView-group"))for(var n=
m.childNodes,t=0,u=n.length;t<u;++t){var w=n[t],v=m.offsetTop;w.classList.contains("amx-listView-divider")||w.classList.contains("amx-listItem-undisclosed")||(m.classList.contains("amx-static")&&(v=0),this._gatherViewportChildInfo(w,h,c,v,d))}else this._gatherViewportChildInfo(m,h,c,0,d)}this._adjustViewportChildren(d.outsideViewport,!1);this._adjustViewportChildren(d.insideViewport,!0)};A.prototype._gatherViewportChildInfo=function(a,b,c,d,e){d=a.offsetTop+d;d+a.offsetHeight<b?e.outsideViewport.push(a):
d>c?e.outsideViewport.push(a):e.insideViewport.push(a)};A.prototype._adjustViewportChildren=function(a,b){i=0;for(aboveCount=a.length;i<aboveCount;++i){var c=a[i];b?c.classList.contains("amx-listItem-outsideOfBuffer")&&(c.style.height=c.getAttribute("data-sh"),c.style.width=c.getAttribute("data-sw"),c.classList.remove("amx-listItem-outsideOfBuffer")):c.classList.contains("amx-listItem-outsideOfBuffer")||(c.setAttribute("data-sh",c.style.height),c.setAttribute("data-sw",c.style.width),c.style.height=
c.offsetHeight+"px",c.style.width=c.offsetWidth+"px",c.classList.add("amx-listItem-outsideOfBuffer"))}};A.prototype.postDisplay=function(a,b){if("yes"!=b.getAttribute("_placeholder")){"nomore"==b.getAttribute("_placeholder")&&(b.setAttributeResolvedValue("_placeholder",null),b.getState()==adf.mf.api.amx.AmxNodeStates.PARTIALLY_RENDERED&&b.setState(adf.mf.api.amx.AmxNodeStates.RENDERED));var c=a.querySelector(".amx-listView-innerList");this._restoreScrollPosition(b,c);C(a,b);c={innerListElement:c,
typeHandler:this,amxNode:b};d(b,"resizeData",c);adf.mf.api.amx.addBubbleEventListener(window,"resize",this._handleResize,c);adf.mf.api.amx.addBubbleEventListener(a,"resize",this._handleResize,c)}};A.prototype._handleResize=function(a){var b=a.data.innerListElement,c=a.data.typeHandler;a=a.data.amxNode;null!=b&&"viewport"==a.getAttribute("bufferStrategy")&&c._updateViewportBuffer(a,b)};var D=function(a){a=a.data;var b=a.getId(),b=document.getElementById(b),c=b.querySelector(".amx-listView-index");
null!=c&&(c._amxLinkHeight=null,c._amxTotalHeight=null);C(b,a,!1)},C=function(a,b,c){var d=a.querySelector(".amx-listView-index"),e=document.getElementById(b.getId()+"_innerList");if(null!==d){var g=b.getAttribute("_indexBarRegister");if(g){a.classList.add("amx-listView-has-index");var h=adf.mf.resource.getInfoString("AMXInfoBundle","amx_listView_INDEX_STRING").toUpperCase(),k=adf.mf.resource.getInfoString("AMXInfoBundle","amx_listView_INDEX_OTHERS").toUpperCase();a=String.fromCharCode(9679);adf.mf.api.amx.emptyHtmlElement(d);
var m=document.createElement("div");m.className="amx-extendedTarget";d.appendChild(m);var m=B(e,d,h.charAt(0),null!=g[h.charAt(0)],"amx-listView-indexCharacter",null),n=d._amxLinkHeight;null==n&&(n=m.offsetHeight,d._amxLinkHeight=n);if(!1!==c){adf.mf.api.amx.addBubbleEventListener(window,"resize",D,b);var t=void 0;adf.mf.api.amx.addDragListener(d,{start:function(a,b){e.classList.add("amx-listView-scrollable-disabled");t=void 0},drag:function(a,b){a.preventDefault();a.stopPropagation();var c=adf.mf.internal.amx.getElementTop(d);
t=I(d,e,b.pageY-c,n,h,k,g,t,!1)},end:function(a,b){e.classList.remove("amx-listView-scrollable-disabled")}});adf.mf.api.amx.addBubbleEventListener(d,"tap",function(a){a.preventDefault();a.stopPropagation();var b=adf.mf.internal.amx.getElementTop(d);t=I(d,e,(a.touches&&0<a.touches.length?a.touches[0].pageY:a.changedTouches&&0<a.changedTouches.length?a.changedTouches[0].pageY:a.pageY)-b,n,h,k,g,t,!0)})}b=d._amxTotalHeight;null==b&&(b=d.offsetHeight,d._amxTotalHeight=b);0===b&&(b=n);var u=Math.floor(b/
n),m=h.length,w=m+1;u<w&&1==u%2&&--u;if(4>u)adf.mf.api.amx.removeDomNode(d);else{b=m-1;c=0;u<w&&(c=Math.floor((u-3)/2),u=c+1,m=m-2-c,w=m/u,c=Math.floor(w),m>c*u+1&&(c=Math.ceil(w)));m=h[0];u="_";w=c+1;for(c=1;c<b;++c)0==c%w&&c+w<=b?(m+=h[c],u+="_"):(m+="_",u+=h[c]);var u=u+"_",m=m+h[b],w=!1,v=null;for(c=1;c<=b;++c){var y=m[c];"_"==y?(y=u[c],w=w||g[y],null==v&&(v=[]),v.push(y)):(null!=v&&B(e,d,a,w,"amx-listView-indexBullet",v.join("")),w=void 0!==g[y],B(e,d,y,w,"amx-listView-indexCharacter",y),w=!1,
v=null)}B(e,d,k,null!=g[k],"amx-listView-indexOther",null)}}else adf.mf.api.amx.removeDomNode(d)}},B=function(a,b,c,d,e,g){a=document.createElement("div");var h="amx-listView-indexItem";d&&(h+=" amx-listView-indexItem-active");a.className=h+" "+e;a.textContent=""+c;null==g&&(g=c);a.setAttribute("data-range",g);b.appendChild(a);return a},I=function(a,b,c,d,e,g,h,k,m){a=Math.round(c/((a.offsetHeight-d)/e.length));c=e.length;if(a<c){if(k!==a||m)if(h[e.charAt(a)])k=a,h[e.charAt(a)]();else for(k=void 0,
m=0;m<c;++m){d=a-m;var n=a+m;if(n>=c){h[g]?(k=-1,h[g]()):(k=void 0,b.scrollTop=b.scrollHeight);break}else if(0<=d&&h[e.charAt(d)]){k=d;h[e.charAt(d)]();break}else if(n<c&&h[e.charAt(n)]){k=n;h[e.charAt(n)]();break}}}else if(-1!==k||m)h[g]?(k=-1,h[g]()):(k=void 0,b.scrollTop=b.scrollHeight);return k};A.prototype.refresh=function(a,b,c){A.superclass.refresh.call(this,a,b,c);if("yes"!=a.getAttribute("_placeholder")){c=a.getId();var d=document.getElementById(c),e=document.getElementById(c+"_innerList");
b.getCollectionChange("value");var g=b.getCustomValue("amxNodeCollectionChanges");null!=g&&this._refreshCollectionChanges(a,g,d,e);if(b.hasChanged("editMode")){if(null!=a&&void 0!==a.getAttribute("value")){e.classList.add("amx-listView-editMode");var h=w(e).querySelector(".amx-listView-index");h&&(adf.mf.api.amx.removeDomNode(h),adf.mf.api.amx.removeBubbleEventListener(window,"resize",D,a));for(var h=e.childNodes,k=0;k<h.length;++k){var t=h[k];if(t.classList.contains("amx-listView-group")){for(var v=
t.childNodes,y=0;y<v.length;++y){var x=v[y];t.removeChild(x);!x.classList.contains("amx-listItem")||x.classList.contains("amx-listItem-moreRows")||x.classList.contains("amx-listView-divider")||e.appendChild(x);--y}adf.mf.api.amx.removeDomNode(t);--k}else t.classList.contains("amx-listItem")&&!t.classList.contains("amx-listItem-moreRows")?(v=document.createElement("div"),v.className="amx-listItem-handle",t.appendChild(v),u(t)):t.classList.contains("amx-listView-divider")&&(adf.mf.api.amx.removeDomNode(t),
--k)}this._createScrollHandler(a,e,d)}d.classList.contains("amx-listView-cards")&&(d.classList.remove("amx-listView-cards"),d.classList.add("amx-listView-rows"))}b.hasChanged("selectedRowKeys")&&(h=a.getAttribute("_selectedRowKey"),null!=b.getOldValue("selectedRowKeys")&&(k=d.querySelector(".amx-listItem-selected"),null!=k&&n(k)),h=a.getChildren(null,h),0<h.length&&(h=document.getElementById(h[0].getId()),null!=h&&m(a,h)));if(b.hasChanged("showMoreStrategy")||b.hasChanged("value")||null!=g)h=!1,k=
a.getAttribute("value"),null!=k&&(h=adf.mf.api.amx.createIterator(k),k=a.getAttribute("maxRows"),h=h.getTotalCount()>k||!h.isAllDataLoaded()),this._addOrRemoveLoadMoreRowsDom(a,c,e,h,!1),b.hasChanged("showMoreStrategy")&&this._createScrollHandler(a,e,d),"viewport"==a.getAttribute("bufferStrategy")&&this._updateViewportBuffer(a,e);this._storeClientState(a,e);null!=g&&g.rowsAdded&&null!=a.getAttribute("_loadMoreRowsPerf")&&this._endLoadMoreRows(a)}};A.prototype.preDestroy=function(a,b){if(null==b.getAttribute("_placeholder")){this._storeClientState(b,
document.getElementById(b.getId()+"_innerList"));var c=b.getVolatileState();c&&(c=c.resizeData)&&adf.mf.api.amx.removeBubbleEventListener(window,"resize",this._handleResize,c);adf.mf.api.amx.removeBubbleEventListener(window,"resize",D,b)}};A.prototype.destroy=function(a,b){if(null==b.getAttribute("_placeholder")){var c=a.querySelector(".amx-listView-innerList");c&&adf.mf.api.amx.removeBubbleEventListener(c,"scroll");a.querySelector(".amx-listView-index")&&adf.mf.api.amx.removeBubbleEventListener(window,
"resize",D,b)}};A.prototype._animatedRemoval=function(a,b,c,d,e){var g=a.offsetHeight,h=a.style;h.height=g+"px";h.minHeight=g+"px";b&&(h.width=a.offsetWidth+"px");a.classList.add(c);adf.mf.internal.amx.stripIds(a);adf.shared.impl.animationUtils._requestAnimationFrame(function(){a.classList.add(d);h=a.style;h.height="0";h.minHeight="0";b&&(h.width="0");adf.shared.impl.animationUtils.addOneTimeTransitionEndWithFailsafe(a,e)})};A.prototype._removeListItemByAmxNode=function(a,b){var c=document.getElementById(b),
d=adf.mf.api.amx.AmxNode.getAmxNodeForElement(c);if(null!=c&&null!=c.parentNode){var e=[],g=c.parentNode,h="cards"==a.getAttribute("layout"),k=!1,m=this;m._animationStarted(a);c.classList.add("amx-animating");e.push(new adf.mf.internal.BasePromise(function(a,b){m._animatedRemoval(c,h,"amx-listItem-delete","amx-listItem-delete-active",function(){adf.mf.api.amx.removeDomNode(c);a()})}));g.classList.contains("amx-listView-group")&&null==g.querySelector(".amx-listItem.amx-node:not(.amx-listItem-delete)")&&
(g.classList.add("amx-animating"),e.push(new adf.mf.internal.BasePromise(function(b,c){m._animatedRemoval(g,h,"amx-listItem-delete","amx-listItem-delete-active",function(){var c=d.getAttribute("_dividerValue"),e=a.getAttribute("_indexBarRegister");null!=e&&null!=e[c]&&(delete e[c],k=!0);adf.mf.api.amx.removeDomNode(g);b()})})));adf.mf.internal.BasePromise.all(e).then(function(){var b=a.getId();m._accountForScrollPositionChanges(a,m);k&&(b=document.getElementById(b))&&C(b,a,!1);m._animationEnded(a)})}};
A.prototype._animateListItemInsert=function(a,b){var c=this;c._animationStarted(a);var d="cards"==a.getAttribute("layout"),e=b.style,g=e.width,h=e.height,k=e.minHeight,m=b.offsetWidth,n=b.offsetHeight;e.height="0";e.minHeight="0";d&&(e.width="0");b.classList.add("amx-listItem-insert");b.classList.add("amx-animating");adf.shared.impl.animationUtils._requestAnimationFrame(function(){b.classList.add("amx-listItem-insert-active");e=b.style;e.height=n+"px";e.minHeight=n+"px";d&&(e.width=m+"px");adf.shared.impl.animationUtils.addOneTimeTransitionEndWithFailsafe(b,
function(){b.classList.remove("amx-listItem-insert");b.classList.remove("amx-listItem-insert-active");e=b.style;e.height=h;e.minHeight=k;d&&(e.width=g);c._accountForScrollPositionChanges(a,c);b.classList.remove("amx-animating");c._animationEnded(a)})})};A.prototype._animationStarted=function(a){if("iOS"==adf.mf.internal.amx.agent.type){var b=a.getAttribute("_animationsInProgress");if(null==b||0==b){var b=0,c=document.getElementById(a.getId());null!=c&&c.classList.add("adfmf-low-memory")}a.setAttributeResolvedValue("_animationsInProgress",
++b)}};A.prototype._animationEnded=function(a){if("iOS"==adf.mf.internal.amx.agent.type){var b=a.getAttribute("_animationsInProgress");if(null!=b&&0!=b){if(1==b){var c=document.getElementById(a.getId());null!=c&&c.classList.remove("adfmf-low-memory")}a.setAttributeResolvedValue("_animationsInProgress",--b)}}};A.prototype._accountForScrollPositionChanges=function(a,b){var c=a.getId(),c=document.getElementById(c+"_innerList");"viewport"==a.getAttribute("bufferStrategy")&&b._updateViewportBuffer(a,c);
var d=[a,b],e=document.createEvent("HTMLEvents");e.initEvent("scroll",!0,!0);e.view=window;e.altKey=!1;e.ctrlKey=!1;e.shiftKey=!1;e.metaKey=!1;e.keyCode=0;e.charCode="a";null!=d&&(e.triggerExtra=d);c.dispatchEvent(e)};A.prototype._refreshCollectionChanges=function(a,b,c,d){var e,g,h,k,m,n=b.updated;g=0;for(h=n.length;g<h;++g)e=n[g],k=a.getRenderedChildren(null,e),0<k.length&&(m=k[0],m.rerender());m=b.removed;g=0;for(h=m.length;g<h;++g)this._removeListItemByAmxNode(a,m[g]);g=b.created;if(b.rowsAdded){m=
a.getAttribute("value");b=adf.mf.api.amx.createIterator(m);for(h=null;b.hasNext();)b.next(),e=b.getRowKey(),m=null,k=a.getRenderedChildren(null,e),0<k.length&&(m=k[0]),null!=m&&1==g[e]&&(e=null==h?null:document.getElementById(h.getId()),this._renderStampedItem(!0,a,d,m,h,e)),null!=m&&(h=m);m=document.getElementById(a.getId()+"_loadMoreRows");null!=m&&m.classList.remove("amx-listItem-scrollStrategyLoading")}a.getState()==adf.mf.api.amx.AmxNodeStates.PARTIALLY_RENDERED&&a.setState(adf.mf.api.amx.AmxNodeStates.RENDERED);
C(c,a,!1);adf.mf.api.amx.isValueTrue(a.getAttribute("showDividerCount"))&&null!=a.getAttribute("_dividerAttrEl")&&this._displayDividerCount(d)};A.prototype._storeClientState=function(a,b){if(null!=b){var c=b.scrollLeft,d=b.scrollTop,e=a.getClientState()||{};if(null!=c||null!=d)e.scrollLeft=c,e.scrollTop=d;e.maxRows=a.getAttribute("maxRows");a.setClientState(e)}};A.prototype._restoreScrollPosition=function(a,b){var c=a.getClientState();if(null!=c&&null!=b){var d=c.scrollLeft;null!=d&&(b.scrollLeft=
d);c=c.scrollTop;null!=c&&(b.scrollTop=c)}else null!=b&&(c=g(a.getAttribute("initialScrollRowKeys")),c=null!=c?c[0]:null,null!=c&&(c=(""+c).replace(/[\\]/g,"\\\\"),c=c.replace(/["]/g,'\\"'),c=b.querySelector('.amx-listItem[data-listViewRk\x3d"'+c+'"]')))&&(b.scrollTop=c.offsetTop)};A.prototype._getDividerElement=function(a,b,c,d,e){var g=null,h=c.getAttribute("_dividerValue");if(null!=h){var k,m=null==d?null:d.getAttribute("_dividerValue"),n=null==e?null:e.parentNode;d=c.getClientState()||{};g=null;
if(h==m)k=n,g=e.nextSibling;else{e=null==n?b.querySelector(".amx-listView-group"):n.nextSibling;if(null!=e&&e.classList.contains("amx-listView-group")&&(m=e.querySelector(".amx-listItem"),null!=m)){var t=adf.mf.api.amx.AmxNode.getAmxNodeForElement(m);h==t.getAttribute("_dividerValue")&&(k=e,g=m)}null==k&&(d.isHidden=!1,k=document.createElement("div"),k.classList.add("amx-listView-group"),k.classList.add("amx-listView-content"),e=a.getAttribute("contentStyle"),null!=e&&k.setAttribute("style",e),null==
n?b.insertBefore(k,b.firstChild):this._appendToListView(!1,a,b,k,n),this._createDivider(a,h,k),n=a.getAttribute("_indexBarRegister"),null!=n&&null==n[h]&&(n[h]=this._createIndexBarHandler(b,k)),a.setAttributeResolvedValue("_indexBarRegister",n))}d.isHidden=k.classList.contains("amx-listView-undisclosed");c.setClientState(d);g={insertBefore:g,element:k}}return g};A.prototype._renderStampedItem=function(a,b,c,d,e,g){var h=this._getDividerElement(b,c,d,e,g);e=d.render();null!=e&&(null!=h?(d.getClientState().isHidden&&
e.classList.add("amx-listItem-undisclosed"),null!=h.insertBefore?h.element.insertBefore(e,h.insertBefore):h.element.appendChild(e),a&&this._animateListItemInsert(b,e)):null!=g?this._appendToListView(a,b,c,e,g):(d=c.querySelector(".amx-listItem.amx-node"),null==d?this._appendToListView(a,b,c,e,null):(c.insertBefore(e,d),a&&this._animateListItemInsert(b,e))));return e};A.prototype._createIndexBarHandler=function(a,b){if(b&&a)return function(){a.scrollTop=b.offsetTop}};A.prototype._displayDividerCount=
function(a){a=a.childNodes;for(var b=0,c=a.length;b<c;++b){var d=a[b];if(d.classList.contains("amx-listView-group"))for(var e=d.querySelectorAll(".amx-listItem:not(.amx-listItem-moreRows):not(.amx-listView-divider):not(.amx-listItem-delete)").length,d=d.querySelectorAll(".amx-listView-divider:not(.amx-listItem-delete)"),g=0;g<d.length;g++){var h=d[g].querySelector(".amx-listView-dividerCounterText");h&&(h.textContent=e)}}};A.prototype._collapseDividerIfNecessary=function(a,b,c){if(a.getAttribute("collapsedDividers")&&
(a=a.getAttribute("collapsedDividers"),null!=a&&-1!=a.indexOf(c)))for(b=b.childNodes,c=0,a=b.length;c<a;++c){var d=b[c];d.classList.contains("amx-listView-disclosedIcon")&&(d.classList.remove("amx-listView-disclosedIcon"),d.classList.add("amx-listView-undisclosedIcon"),d=d.parentNode.parentNode,d.classList.contains("amx-listView-undisclosed")||d.classList.add("amx-listView-undisclosed"))}};A.prototype._renderHeaderFacet=function(a,b,c){a=a.getRenderedChildren("header");if(a.length){c=document.createElement("div");
c.className="amx-listView-header";b.appendChild(c);b=document.createElement("div");b.className="amx-listView-facet-header";c.appendChild(b);c=0;for(var d=a.length;c<d;++c){var e=a[c].render();e&&b.appendChild(e)}}};A.prototype._appendToListView=function(a,b,c,d,e){e?z(c,e,d):c.appendChild(d);a&&this._animateListItemInsert(b,d)};A.prototype._appendFooter=function(a,b){var c=a.getRenderedChildren("footer");if(c.length){var d=document.createElement("div");d.className="amx-listView-footer";b.appendChild(d);
var e=document.createElement("div");e.className="amx-listView-facet-footer";d.appendChild(e);for(var d=0,g=c.length;d<g;++d){var h=c[d].render();h&&e.appendChild(h)}}};A.prototype._getCurrentDivider=function(a,b){var c=adf.mf.el.getLocalValue(b);if(adf.mf.environment.profile.dtMode)return b;if(void 0===c)throw new adf.mf.PropertyNotFoundException(adf.mf.resource.getInfoString("AMXInfoBundle","amx_listView_LABEL_UNKNOWN_DIVIDER_ATTRIBUTE",a.getAttribute("dividerAttribute")+" / "+b));if("firstLetter"===
a.getAttribute("dividerMode")&&null!=c){var c=c.charAt(0),c=c.toUpperCase(),d=adf.mf.resource.getInfoString("AMXInfoBundle","amx_listView_INDEX_STRING").toUpperCase(),e=adf.mf.resource.getInfoString("AMXInfoBundle","amx_listView_INDEX_OTHERS").toUpperCase(),g=adf.mf.resource.getInfoString("AMXInfoBundle","amx_listView_INDEX_ACCENT_MAP").toUpperCase();if(-1<d.indexOf(c))return""+c;d=g.indexOf(c);if(0<d){for(;"|"!==g.charAt(d)&&"|"!==g.charAt(--d);)c=g.charAt(d);return c}return""+e}return""+c};A.prototype._createDivider=
function(a,d,e){var g=document.createElement("div");e.appendChild(g);g.setAttribute("tabindex","0");if(adf.mf.api.amx.isValueTrue(a.getAttribute("collapsibleDividers"))){if(g.className="amx-listView-divider",e=document.createElement("div"),e.className="amx-listView-disclosedIcon",e.setAttribute("role","button"),e.setAttribute("aria-expanded","true"),g.appendChild(e),e=document.createElement("div"),e.setAttribute("role","heading"),e.className="amx-listView-dividerText",e.textContent=d,g.appendChild(e),
adf.mf.api.amx.isValueTrue(a.getAttribute("showDividerCount"))){e=document.createElement("div");e.className="amx-listView-dividerCounter";g.appendChild(e);var h=document.createElement("div");h.className="amx-listView-dividerCounterText";e.appendChild(h)}}else g.className="amx-listView-divider amx-listView-nonCollapsibleDivider",e=document.createElement("div"),e.setAttribute("role","heading"),e.className="amx-listView-nonCollapsibleDivider amx-listView-dividerText",e.textContent=d,g.appendChild(e),
adf.mf.api.amx.isValueTrue(a.getAttribute("showDividerCount"))&&(e=document.createElement("div"),e.className="amx-listView-dividerCounter",g.appendChild(e),h=document.createElement("div"),h.className="amx-listView-dividerCounterText",e.appendChild(h));adf.mf.internal.amx._setNonPrimitiveElementData(g,"items",[]);if(adf.mf.api.amx.isValueTrue(a.getAttribute("collapsibleDividers"))){this._collapseDividerIfNecessary(a,g,d);var k=this;adf.mf.api.amx.addDragListener(g,{start:function(a,b){},drag:function(a,
b){},end:function(a,b){},threshold:5});adf.mf.api.amx.addBubbleEventListener(g,"tap",function(d){if(adf.mf.api.amx.acceptEvent()){var e=this;if(!e.classList.contains("amx-animating")){e.classList.add("amx-animating");y(function(){return function(){for(var d=e.nextSibling,g=!1,h=[],m=d.className;null!=d&&-1==m.indexOf("amx-listItem-moreRows")&&-1!=m.indexOf("amx-listItem")&&-1==m.indexOf("amx-listView-divider");){var m=adf.mf.internal.amx._getNonPrimitiveElementData(d,"amxNode"),n=m.getClientState();
null==n&&(n={});d.classList.contains("amx-listItem-undisclosed")||d.classList.contains("amx-listItem-disclosing")?(h.push(b(d)),n.isHidden=!1):(h.push(c(d)),g=n.isHidden=!0);m.setClientState(n);d=d.nextSibling;m=null!=d?d.className:""}d=a.getId();m=document.getElementById(d+"_innerList");!0===g&&m.scrollTop>e.parentNode.offsetTop&&(e.classList.remove("amx-bottom"),m.scrollTop=e.parentNode.offsetTop);m.scrollHeight<=m.offsetHeight&&(g=document.getElementById(d+"_loadMoreRows"),null!=g&&g.classList.remove("amx-listItem-scrollStrategy"));
adf.mf.internal.BasePromise.all(h).then(function(){k._accountForScrollPositionChanges(a,k);e.classList.remove("amx-animating")})}}());d=e.childNodes;for(var g=0,h=d.length;g<h;++g){var m=d[g];m.classList.contains("amx-listView-disclosedIcon")?(m.classList.remove("amx-listView-disclosedIcon"),m.classList.add("amx-listView-undisclosedIcon"),m.setAttribute("aria-expanded","false"),m=m.parentNode.parentNode,m.classList.add("amx-listView-undisclosed")):m.classList.contains("amx-listView-undisclosedIcon")&&
(m.classList.remove("amx-listView-undisclosedIcon"),m.classList.add("amx-listView-disclosedIcon"),m.setAttribute("aria-expanded","true"),m=m.parentNode.parentNode,m.classList.remove("amx-listView-undisclosed"))}}}})}return g};A.prototype._createAndAppendTheMoreRowsDom=function(a,b,c,d){var e=adf.mf.resource.getInfoString("AMXInfoBundle","amx_listView_MSG_LOAD_MORE_ROWS"),g=document.createElement("div");g.id=b+"_loadMoreRows";g.setAttribute("role","button");g.setAttribute("tabindex","0");d&&c.scrollHeight<=
c.offsetHeight&&(d=!1);d?(g.className="amx-listItem amx-listItem-moreRows amx-listItem-scrollStrategy",g.setAttribute("aria-label",e)):g.className="amx-listItem amx-listItem-moreRows";b=document.createElement("span");b.appendChild(document.createTextNode(e));b.className="amx-outputText";g.appendChild(b);c.appendChild(g);adf.mf.api.amx.addBubbleEventListener(g,"tap",this._handleMoreRowsTap,a)};A.prototype._addOrRemoveLoadMoreRowsDom=function(a,b,c,d,e){var g=null;e||(g=document.getElementById(b+"_loadMoreRows"));
e=a.getAttribute("showMoreStrategy");"off"==e?d=!1:"forceLink"==e?d=!0:"forceScroll"==e&&(d=!0);e="autoScroll"==e||"forceScroll"==e;var h=a.getAttribute("_renderedScrollStrategy");a.setAttributeResolvedValue("_renderedScrollStrategy",e);d&&null==g?this._createAndAppendTheMoreRowsDom(a,b,c,e):d||null==g?null!=g&&h!=e&&(adf.mf.api.amx.removeDomNode(g),this._createAndAppendTheMoreRowsDom(a,b,c,e)):adf.mf.api.amx.removeDomNode(g)};A.prototype._handleMoreRowsTap=function(a){a=a.data;a.getTypeHandler()._handleMoreRowsAction(a)};
A.prototype._queueRangeChangeListener=function(a,b,c,d){if(null!=a.getAttributeExpression("rangeChangeListener")){var e=a.getId(),g=null;if(null!=b&&(g=b.getRowKey(),0<c)){var h=b.getRowKey();b.setCurrentIndex(c-1);g=b.getRowKey();null!=h&&b.setCurrentRowKey(h)}b=null;c=a.getAttributeExpression("value");null!=c&&(b=adf.mf.util.getContextFreeExpression(c));d=new adf.mf.api.amx.RangeChangeEvent(e,b,g,d);adf.mf.api.amx.processAmxEvent(a,"rangeChange",void 0,void 0,d)}};A.prototype._handleMoreRowsAction=
function(a){var b=a.getAttribute("fetchSize"),c=a.getAttribute("maxRows"),d=a.getAttribute("value"),e=adf.mf.internal.perf.startMonitorOperation("Load more rows for list view with ID "+a.getId(),adf.mf.log.level.FINE,"amx:listView.loadMoreRows");a.setAttributeResolvedValue("_loadMoreRowsPerf",e);e=window.setTimeout(function(){null!=a.getAttribute("_loadMoreRowsPerf")&&a.getTypeHandler()._endLoadMoreRows(a)},1E4);a.setAttributeResolvedValue("_loadMoreRowsPerfTimeout",e);if(void 0===b||void 0===c||
void 0===d)this._queueRangeChangeListener(a,null,0,0);else if(Infinity==c&&Infinity==b&&null!=a.getAttribute("rangeChangeListener"))this._queueRangeChangeListener(a,null,0,0);else{var g=c;adf.mf.api.amx.showLoadingIndicator();if(0<b){a.setAttributeResolvedValue("_oldMaxRows",g);Infinity!=c&&(c+=b,a.setAttributeResolvedValue("maxRows",c));e=document.getElementById(a.getId()+"_innerList");this._storeClientState(a,e);var e=adf.mf.api.amx.createIterator(d),h=e.getAvailableCount(),k=e.getTotalCount();
(k>h||!e.isAllDataLoaded())&&h<c?(this._queueRangeChangeListener(a,e,h,b),e.isTreeNodeIterator()?(Infinity===g&&(g=0),a.setState(adf.mf.api.amx.AmxNodeStates.PARTIALLY_RENDERED),adf.mf.api.amx.bulkLoadProviders(d,g,c,function(){try{var b=a.getAttribute("_oldMaxRows");if(g==b){var c=new adf.mf.api.amx.AmxNodeUpdateArguments;c.setAffectedAttribute(a,"maxRows");adf.mf.api.amx.markNodeForUpdate(c)}}finally{adf.mf.api.amx.hideLoadingIndicator()}},function(a,b){adf.mf.api.adf.logInfoResource("AMXInfoBundle",
adf.mf.log.level.SEVERE,"amx:listView._handleMoreRowsAction","MSG_ITERATOR_FIRST_NEXT_ERROR");adf.mf.log.Framework.isLoggable(adf.mf.log.level.FINE)&&adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"amx:listView","_handleMoreRowsAction","Request: "+a+" response: "+b);adf.mf.api.amx.hideLoadingIndicator()})):adf.mf.api.amx.hideLoadingIndicator()):(k<=h&&h<c&&null!=a.getAttributeExpression("rangeChangeListener")?this._queueRangeChangeListener(a,e,h,b):(b=new adf.mf.api.amx.AmxNodeUpdateArguments,b.setAffectedAttribute(a,
"maxRows"),adf.mf.api.amx.markNodeForUpdate(b)),adf.mf.api.amx.hideLoadingIndicator())}}};A.prototype.__experimentalCLAssociation=function(a,b,c,d){"scroll"==c&&d.classList.add("amx-listView-hasScrollClientListener");A.superclass.__experimentalCLAssociation.call(this,a,b,c,d,!1)};var K=adf.mf.api.amx.TypeHandler.register(adf.mf.api.amx.AmxTag.NAMESPACE_AMX,"listItem");K.prototype.render=function(a,b){var c=document.createElement("div"),d=a.getAttribute("shortDesc");c.setAttribute("tabindex","0");
null!=d&&c.setAttribute("title",d);adf.mf.api.amx.isValueFalse(a.getAttribute("showLinkIcon"))?c.className="amx-listItem-noCaret":(d=document.createElement("div"),d.className="amx-listItem-caret",c.appendChild(d));null!=a.getAttributeExpression("action",!0)&&c.setAttribute("role","button");for(var d=a.renderDescendants(),e=0,g=d.length;e<g;++e)c.appendChild(d[e]);adf.mf.api.amx.enableAmxEvent(a,c,"swipe");adf.mf.api.amx.enableAmxEvent(a,c,"tapHold");d=a.getParent();e=d.getAttribute("_selectedRowKey");
null!==e&&e==a.getStampKey()&&m(d,c);c.setAttribute("data-listViewRk",a.getStampKey());d=a.getClientState();null!=d&&1==d.isHidden&&c.classList.add("amx-listItem-undisclosed");d=a.getParent();void 0!==d.getAttribute("value")&&adf.mf.api.amx.isValueTrue(d.getAttribute("editMode"))&&(d=document.createElement("div"),d.className="amx-listItem-handle",c.appendChild(d),u(c));adf.mf.api.amx.addBubbleEventListener(c,"tap",this._handleTap,{elementId:b,itemAmxNode:a});return c};K.prototype._handleTap=function(a){a.stopPropagation();
a.preventDefault();var b=document.getElementById(a.data.elementId);if(null!=b){var c=w(b),d=a.data.itemAmxNode;a=d.getParent();var e=a.getAttribute("_selectedRowKey"),g=b.getAttribute("data-listViewRk");c.classList.contains("amx-listView-editMode")||b.classList.contains("amx-listItem-moreRows")||(c=c.querySelector(".amx-listItem-selected"),null!=c&&n(c),m(a,b),h(g,a),adf.mf.api.amx.isValueTrue(a.getAttribute("editMode"))||(adf.mf.api.amx.acceptEvent()&&(c=new adf.mf.api.amx.SelectionEvent(e,[g]),
adf.mf.api.amx.processAmxEvent(a,"selection",void 0,void 0,c)),adf.mf.api.amx.validate(b,function(){if(adf.mf.api.amx.acceptEvent()){var a=new adf.mf.api.amx.ActionEvent;adf.mf.api.amx.processAmxEvent(d,"action",void 0,void 0,a,function(){var a=d.getAttributeExpression("action",!0);null!=a&&adf.mf.api.amx.doNavigation(a)})}})))}};K=adf.mf.api.amx.TypeHandler.register(adf.mf.api.amx.AmxTag.NAMESPACE_AMX,"iterator");K.prototype.createChildrenNodes=function(a){if(!a.isAttributeDefined("value"))return!1;
var b;if(adf.mf.environment.profile.dtMode)b=[{},{},{}],a.setAttributeResolvedValue("value",b);else{b=a.getAttribute("value");if(void 0===b)return a.setState(adf.mf.api.amx.AmxNodeStates.INITIAL),!0;if(null==b)return!0}var c=adf.mf.api.amx.createIterator(b);if(c.getTotalCount()>c.getAvailableCount())return!0!==a.getAttribute("_bulkLoad")&&(a.setAttributeResolvedValue("_bulkLoad",!0),adf.mf.api.amx.showLoadingIndicator(),adf.mf.api.amx.bulkLoadProviders(b,0,-1,function(){a.setAttributeResolvedValue("_bulkLoad",
null);try{var b=new adf.mf.api.amx.AmxNodeUpdateArguments;b.setAffectedAttribute(a,"value");b.setAffectedAttribute(a,"_bulkLoad");adf.mf.api.amx.markNodeForUpdate(b)}finally{adf.mf.api.amx.hideLoadingIndicator()}},function(b,c){a.setAttributeResolvedValue("_bulkLoad",null);adf.mf.log.logInfoResource("AMXInfoBundle",adf.mf.log.level.SEVERE,"amx:iterator.createChildrenNodes","MSG_ITERATOR_FIRST_NEXT_ERROR");adf.mf.log.Framework.isLoggable(adf.mf.log.level.FINE)&&adf.mf.log.Framework.logp(adf.mf.log.level.FINE,
"amx:iterator","createChildrenNodes","Request: "+b+" response: "+c);adf.mf.api.amx.hideLoadingIndicator()})),a.setState(adf.mf.api.amx.AmxNodeStates.INITIAL),!0;for(;c.hasNext();)c.next(),a.createStampedChildren(c.getRowKey(),[null]);a.setState(adf.mf.api.amx.AmxNodeStates.ABLE_TO_RENDER);return!0};K.prototype.updateChildren=function(a,b){if(b.hasChanged("value")){var c=b.getCollectionChange("value");if(null!=c&&c.isItemized()&&0==c.getCreatedKeys().length&&0==c.getDeletedKeys().length&&0==c.getDirtiedKeys().length){for(var c=
c.getUpdatedKeys(),d=0,e=c.length;d<e;++d){for(var g=c[d],h=a.removeChildrenByKey(g),k=0,m=h.length;k<m;++k)adf.mf.api.amx.removeDomNode(document.getElementById(h[k].getId()));a.createStampedChildren(g,[null])}return adf.mf.api.amx.AmxNodeChangeResult.RERENDER}return adf.mf.api.amx.AmxNodeChangeResult.REPLACE}return adf.mf.api.amx.AmxNodeChangeResult.RERENDER};K.prototype.visitChildren=function(b,c,d){for(var g=b.getAttribute("value"),g=adf.mf.api.amx.createIterator(g),h=b.getAttribute("var"),k=b.getAttributeExpression("value",
!1,!0);g.hasNext();){var m=g.next();adf.mf.el.pushVariable(h,m);try{if(a(b,g,h,k),b.visitStampedChildren(g.getRowKey(),[null],null,c,d))return!0}finally{adf.mf.el.popVariable(h),e(b,g)}}return!1};K.prototype.isFlattenable=function(a){return!0}})();