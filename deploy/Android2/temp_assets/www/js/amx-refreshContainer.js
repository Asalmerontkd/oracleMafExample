(function(){var b=adf.mf.api.amx.TypeHandler.register(adf.mf.api.amx.AmxTag.NAMESPACE_AMX,"refreshContainer");b.prototype.render=function(c,a){var e=document.createElement("div"),d=document.createElement("div");d.id=a+"_pocketWrapper";d.className="amx-refreshContainer-pocketWrapper";e.appendChild(d);var g=document.createElement("div");g.id=a+"_pocket";g.className="amx-refreshContainer-pocket amx-0";g.setAttribute("aria-hidden","true");var h=document.createElement("div");h.id=a+"_icon";h.className=
"amx-refreshContainer-icon";g.appendChild(h);var k=document.createElement("div");k.id=a+"_text";k.className="amx-refreshContainer-text";var m=c.getAttribute("pullText");null!=m&&""!=m&&g.classList.add("amx-hasText");h=c.getAttribute("busyText");if(null==h||""==h)h=m;k.textContent=m;k.setAttribute("data-pulltext",m);g.appendChild(k);k=document.createElement("div");k.id=a+"_subText";k.className="amx-refreshContainer-subText";m=c.getAttribute("subText");null!=m&&""!=m&&(k.textContent=m,g.classList.add("amx-hasSubText"));
g.appendChild(k);d.appendChild(g);d=document.createElement("div");d.id=a+"_content";d.className="amx-refreshContainer-content";e.appendChild(d);for(var k=c.renderDescendants(),m=0,n=k.length;m<n;++m)d.appendChild(k[m]);adf.mf.api.amx.addDragListener(e,{start:b._handleDragStart,drag:b._handleDrag,end:b._handleDragEnd,threshold:5},{id:a,busyText:h,amxNode:c});adf.mf.api.amx.addBubbleEventListener(g,"tap",b._handleReset,a);g=c.getAttribute("refreshDesc");if(null==g||""==g)g=adf.mf.resource.getInfoString("AMXInfoBundle",
"amx_refreshContainer_REFRESH_BUTTON");e.appendChild(b._createRefreshLink(g,a,c));return e};b.prototype.attributeChangeResult=function(c,a,e){switch(a){case "refreshCompleteExpression":case "subText":return adf.mf.api.amx.AmxNodeChangeResult.REFRESH;default:return b.superclass.attributeChangeResult.call(this,c,a,e)}};b.prototype.refresh=function(c,a,e){var d=c.getId(),g=a.hasChanged("refreshCompleteExpression"),h=a.hasChanged("subText");g&&b._handleReset({data:d});h&&(g=document.getElementById(d+
"_subText"),h=c.getAttribute("subText"),g.textContent=h,d=document.getElementById(d+"_pocket"),d.classList.remove("amx-hasSubText"),null!=h&&""!=h&&(g.textContent=h,d.classList.add("amx-hasSubText")));b.superclass.refresh.call(this,c,a,e)};b._createRefreshLink=function(c,a,e){var d=document.createElement("a");d.setAttribute("id",a+"_refresh");d.className="amx-refreshContainer_refresh-link";d.setAttribute("tabindex",0);adf.mf.api.amx.addBubbleEventListener(d,"click",function(a){a.stopPropagation();
a.preventDefault()});d.setAttribute("href","#");adf.mf.api.amx.addBubbleEventListener(d,"click",b._handleRefresh,{id:a,amxNode:e});d.textContent=c;return d};b._handleRefresh=function(c){c=c.data;var a=c.id,e=c.amxNode;c=e.getTag();var d=document.getElementById(a);null!=d&&adf.mf.api.amx.validate(d,function(){if(adf.mf.api.amx.acceptEvent()){var a=new amx.ActionEvent;adf.mf.api.amx.processAmxEvent(e,"action",void 0,void 0,a,function(){var a=e.getAttributeExpression("action",!0,!0);null!=a&&adf.mf.api.amx.doNavigation(a)})}});
c.isAttributeElBound("refreshCompleteExpression")||(adf.mf.environment.profile.mockData?(adf.mf.api.amx.showLoadingIndicator(),adf.mf.api.finishAnyLoading().then(function(){b._handleReset({data:a})}),window.setTimeout(function(){adf.mf.api.amx.hideLoadingIndicator()},1E3)):adf.mf.api.finishAnyLoading().then(function(){b._handleReset({data:a})}))};b._handleReset=function(b){var a=b.data;b=document.getElementById(a+"_pocketWrapper");if(b.classList.contains("amx-dragging")){var e=document.getElementById(a+
"_pocket");e.setAttribute("data-finishedRefresh","true")}else{b.classList.remove("amx-dragging");var d=document.getElementById(a+"_content");d.classList.remove("amx-dragging");e=document.getElementById(a+"_pocket");e.className=e.className.replace(/amx-[0-9]+/,"amx-0");e.setAttribute("data-finishedRefresh","true");a=document.getElementById(a+"_text");a.textContent=a.getAttribute("data-pulltext");b.style.height="0px";adf.shared.impl.animationUtils._setTransformTranslate(d,"0, 0")}};b._handleDragStart=
function(c,a){for(var e=c.srcElement,d=c.data;null!=e&&e!=this;){if(0<e.scrollTop){d.scrolledToTop=!1;return}e=e.parentElement}var g=d.id;b._handleReset({data:g});var e=document.querySelector(".amx-refreshContainer-pocket#"+g+"_pocket"),h=e.offsetHeight;d.consuming=!1;d.startPageY=null;d.scrolledToTop=!0;d.refreshDistance=h;d.restingDistance=0;var k=adf.mf.internal.amx.getComputedStyle(e).bottom,k=isNaN(parseInt(k,10)),m=document.querySelector(".amx-refreshContainer-icon#"+g+"_icon"),g=0,n=m.offsetTop,
m=m.offsetHeight;isNaN(n)||isNaN(m)||(g=k?n+.75*m:h-(n+.25*m));d.distanceWithoutChange=g;e.setAttribute("data-finishedRefresh","false")};b._handleDrag=function(c,a){var e=c.data;if(e.scrolledToTop){var d=e.id,g=this.querySelector(".amx-refreshContainer-pocket#"+d+"_pocket");if(null!=g&&null!=g.getAttribute){var h="true"==g.getAttribute("data-finishedRefresh");if(h||adf.mf.api.amx.acceptEvent()){var k=Math.abs(a.originalAngle);if(60<=k&&120>=k)if(k=e.startPageY,null==k)e.startPageY=a.pageY;else{var k=
a.pageY-k,m=0<k||e.consuming;if(h||m&&a.requestDragLock(this,!1,!0)){c.preventDefault();c.stopPropagation();a.preventDefault=!0;a.stopPropagation=!0;e.consuming=!0;var n=this.querySelector(".amx-refreshContainer-pocketWrapper#"+d+"_pocketWrapper");n.classList.add("amx-dragging");var t=this.querySelector(".amx-refreshContainer-content#"+d+"_content");t.classList.add("amx-dragging");var m=e.refreshDistance,u=Math.max(0,k);n.style.height=u+"px";adf.shared.impl.animationUtils._setTransformTranslate(t,
"0, "+u+"px");n=e.distanceWithoutChange;t=0;h?t=10:k>n&&(t=Math.min(10,Math.max(0,Math.round((k-n)/(m-n)*10))));h||g.classList.contains("amx-10")||(10==t?(g.className=g.className.replace(/amx-[0-9]+/,"amx-10"),e.restingDistance=m,this.querySelector(".amx-refreshContainer-text#"+d+"_text").textContent=e.busyText,b._handleRefresh({data:{id:d,amxNode:e.amxNode}})):(g.className=g.className.replace(/amx-[0-9]+/,"amx-"+t),e.restingDistance=0))}}}else e.consuming=!1}}};b._handleDragEnd=function(c,a){var e=
c.data;if(e.scrolledToTop){var d=e.id,g=this.querySelector(".amx-refreshContainer-pocket#"+d+"_pocket");if(null!=g&&null!=g.getAttribute){var h=g.getAttribute("data-finishedRefresh"),g=this.querySelector(".amx-refreshContainer-pocketWrapper#"+d+"_pocketWrapper"),k=this.querySelector(".amx-refreshContainer-content#"+d+"_content");g.classList.remove("amx-dragging");k.classList.remove("amx-dragging");"false"==h?(e=e.restingDistance,g.style.height=e+"px",adf.shared.impl.animationUtils._setTransformTranslate(k,
"0, "+e+"px")):b._handleReset({data:d})}}}})();