(function(){function b(b,a,e){this.Init(b,a,e)}adf.mf.internal.amx.AmxTagInstanceStates={WAITING_ON_EL_EVALUATION:0,LOADED:1};adf.mf.internal.amx.AmxTagInstance=b;adf.mf.api.AdfObject.createSubclass(adf.mf.internal.amx.AmxTagInstance,adf.mf.api.AdfObject,"adf.mf.internal.amx.AmxTagInstance");adf.mf.internal.amx.AmxTagInstance.prototype.Init=function(c,a,e){b.superclass.Init.call(this);this._parentAmxNode=c;this._parentTagInstance=a;this._tag=e;this._elAttributeMap={};this._tagHandler=adf.mf.internal.amx.AmxTagHandler.__getHandler(e.getNsPrefixedName());
this._attributesWaitingOnEl=0;this._attributeNamesWaitingOnEl={};this._state=adf.mf.internal.amx.AmxTagInstanceStates.LOADED;this._cachedAttributes={};this._attrs={};c=e.getAttributes();for(var d in c)e=c[d],"id"!=d&&adf.mf.api.amx.AmxTag.__isELExpression(e)&&(e=adf.mf.internal.el.parser.parse(e),e=adf.mf.api.amx.AmxNode.__performElSubstitutions(e),this._elAttributeMap[d]=e,this._tagHandler.shouldPrefetchAttribute(d,e)&&(e=adf.mf.internal.amx.evaluateExpression(e),this._attrs[d]=e,this._cachedAttributes[d]=
!0,void 0===e&&(this._state=adf.mf.internal.amx.AmxTagInstanceStates.WAITING_ON_EL_EVALUATION,++this._attributesWaitingOnEl,this._attributeNamesWaitingOnEl[d]=!0)));this._elDependencies=new adf.mf.internal.amx.AmxElDependencies(this._elAttributeMap);this._tagHandler.initializeTagInstance(this);this._children=[];null!=a&&a._children.push(this)};adf.mf.internal.amx.AmxTagInstance.prototype.getParentAmxNode=function(){return this._parentAmxNode};adf.mf.internal.amx.AmxTagInstance.prototype.getParentTagInstance=
function(){return this._parentTagInstance};adf.mf.internal.amx.AmxTagInstance.prototype.getTag=function(){return this._tag};adf.mf.internal.amx.AmxTagInstance.prototype.getChildren=function(b,a){for(var e=[],d=0,g=this._children.length;d<g;++d){var h=this._children[d];if(null!=b){var k=h.getTag();if(null!=a&&a!=k.getName()||b!=k.getNamespace())continue}e.push(h)}return e};adf.mf.internal.amx.AmxTagInstance.prototype.getAttributeExpression=function(b){return this._elAttributeMap[b]};adf.mf.internal.amx.AmxTagInstance.prototype.getAttribute=
function(b,a){void 0===a&&(a=!0);if(a&&1==this._cachedAttributes[b])return this._attrs[b];var e=this.getAttributeExpression(b);return null==e?this.getTag().getAttribute(b):a?adf.mf.internal.amx.evaluateExpression(e):e.getExpression()};adf.mf.internal.amx.AmxTagInstance.prototype.updateAttributes=function(b){for(var a=0,e=b.length;a<e;++a){var d=b[a];if(1==this._cachedAttributes[d]){var g=this.getAttributeExpression(d),g=adf.mf.internal.amx.evaluateExpression(g),h=this._attrs[d];this._attrs[d]=g;this._tagHandler.attributeUpdated(this,
d,h,g);void 0!==g&&this._attributeNamesWaitingOnEl[d]&&(delete this._attributeNamesWaitingOnEl[d],0==--this._attributesWaitingOnEl&&(this._state=adf.mf.internal.amx.AmxTagInstanceStates.LOADED))}}};adf.mf.internal.amx.AmxTagInstance.prototype.setAttribute=function(b,a){void 0===a?(delete this._cachedAttributes[b],delete this._attrs[b]):(this._cachedAttributes[b]=!0,this._attrs[b]=a)};adf.mf.internal.amx.AmxTagInstance.prototype.getElDependencies=function(){return this._elDependencies};adf.mf.internal.amx.AmxTagInstance.prototype.getState=
function(){return this._state}})();