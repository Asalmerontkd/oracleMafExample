(function(){var b=adf.mf.internal.dvt.AttributeProcessor,c=adf.mf.internal.dvt.DOMUtils,a=function(){this._oracleMVApiLoaded=this._googleApiLoaded=this._configuration=null;this._waitingNodes=[]};adf.mf.internal.dvt.DvtmObject.createSubclass(a,"adf.mf.internal.dvt.BaseComponentRenderer","adf.mf.internal.dvt.geomap.GeographicMapRenderer");a.prototype.createChildrenNodes=function(a){if(null===this._configuration)return this._waitingNodes.push(a),a.setAttributeResolvedValue("_configuration","waiting"),
this._loadConfiguration(function(a){var b=new adf.mf.api.amx.AmxNodeUpdateArguments,c=this;this._waitingNodes.forEach(function(d){c._mapConfigurationToAmxNode(d,a);b.setAffectedAttribute(d,"_configuration")});this._waitingNodes.length=0;adf.mf.api.amx.markNodeForUpdate(b)},function(){var a=new adf.mf.api.amx.AmxNodeUpdateArguments;this._waitingNodes.forEach(function(b){b.setAttributeResolvedValue("_configuration","failure");a.setAffectedAttribute(b,"_configuration")});this._waitingNodes.length=0;
adf.mf.api.amx.markNodeForUpdate(a)}),adf.mf.api.amx.AmxNodeCreateChildrenNodesResult.HANDLED;this._mapConfigurationToAmxNode(a,this._configuration);if("NotReachable"!==this._configuration.networkStatus)switch(this._configuration.mapProvider){case "oraclemaps":if(!0===this._oracleMVApiLoaded)return a.setAttributeResolvedValue("_apiLoaded","success"),!1;this._loadApi(a,this._loadOracleMVApi);return adf.mf.api.amx.AmxNodeCreateChildrenNodesResult.HANDLED;default:if(!0===this._googleApiLoaded)return a.setAttributeResolvedValue("_apiLoaded",
"success"),!1;this._loadApi(a,this._loadGoogleApi);return adf.mf.api.amx.AmxNodeCreateChildrenNodesResult.HANDLED}else return a.setAttributeResolvedValue("_apiLoaded","failure"),adf.mf.api.amx.AmxNodeCreateChildrenNodesResult.HANDLED};a.prototype._mapConfigurationToAmxNode=function(a,b){a.setAttributeResolvedValue("_configuration","success");a.setAttributeResolvedValue("_networkAvailable","NotReachable"!==b.networkStatus);a.setAttributeResolvedValue("_mapProvider",b.mapProvider);a.setAttributeResolvedValue("_mapViewerUrl",
b.mapViewerUrl);a.setAttributeResolvedValue("_eLocationUrl",b.eLocationUrl);a.setAttributeResolvedValue("_enableXMLHTTP",adf.mf.api.amx.isValueTrue(b.enableXMLHTTP));a.setAttributeResolvedValue("_proxyUrl",b.proxyUrl);a.setAttributeResolvedValue("_baseMap",b.baseMap);a.setAttributeResolvedValue("_geoMapClientId",b.geoMapClientId);a.setAttributeResolvedValue("_geoMapKey",b.geoMapKey);a.setAttributeResolvedValue("_accessibilityEnabled",adf.mf.api.amx.isValueTrue(b.accessibilityEnabled))};var e=function(a){return function(){var b=
new adf.mf.api.amx.AmxNodeUpdateArguments;this._waitingNodes.forEach(function(c){c.setAttributeResolvedValue("_apiLoaded",a);b.setAffectedAttribute(c,"_apiLoaded")});this._waitingNodes.length=0;adf.mf.api.amx.markNodeForUpdate(b)}};a.prototype._loadApi=function(a,b){a.setAttributeResolvedValue("_apiLoaded","waiting");this._waitingNodes.push(a);b.call(this,e("success"),e("failure"))};a.prototype.updateChildren=function(a,b){return b.hasChanged("_configuration")&&"success"===a.getAttribute("_configuration")?
adf.mf.api.amx.AmxNodeChangeResult.REPLACE:b.hasChanged("_configuration")&&"reload"===a.getAttribute("_configuration")?(this._configuration=null,adf.mf.api.amx.AmxNodeChangeResult.REPLACE):b.hasChanged("_apiLoaded")&&"success"===a.getAttribute("_apiLoaded")?adf.mf.api.amx.AmxNodeChangeResult.REPLACE:adf.mf.api.amx.AmxNodeChangeResult.REFRESH};a.prototype._loadConfiguration=function(a,b){if(!0!==this._isLoading){this._isLoading=!0;var c={"#{deviceScope.hardware.networkStatus}":"networkStatus","#{applicationScope.configuration.mapProvider}":"mapProvider",
"#{applicationScope.configuration.geoMapKey}":"geoMapKey","#{applicationScope.configuration.geoMapClientId}":"geoMapClientId","#{applicationScope.configuration.mapViewerUrl}":"mapViewerUrl","#{applicationScope.configuration.eLocationUrl}":"eLocationUrl","#{applicationScope.configuration.proxyUrl}":"proxyUrl","#{applicationScope.configuration.enableXMLHTTP}":"enableXMLHTTP","#{applicationScope.configuration.baseMap}":"baseMap","#{applicationScope.configuration.accessibilityEnabled}":"accessibilityEnabled"},
e=this,m=Object.keys(c);this._configuration=null;adf.mf.internal.isJavaAvailable()?adf.mf.el.getValue(m,function(b,g){var m={},v=function(a){var b=a.getExpression();(a=adf.mf.el.getLocalValue(b))&&!0===a[".null"]&&(a=null);e._configuration&&(b=c[b],"mapProvider"===b&&a&&(a=a.toLowerCase()),e._configuration[b]=a)};g.forEach(function(a){var b=c[a.name],d=a.value;d&&!0===d[".null"]&&(d=null);"mapProvider"===b&&d&&(d=d.toLowerCase());m[b]=d;adf.mf.api.addDataChangeListeners(a.name,v)});e._configuration=
m;e._isLoading=!1;a.call(e,m)},function(a,c){e._configuration=null;b.call(e);e._isLoading=!1}):(this._configuration={},m.forEach(function(a){var b=c[a];(a=adf.mf.el.getLocalValue(a))&&!0===a[".null"]&&(a=null);"mapProvider"===b&&a&&(a=a.toLowerCase());e._configuration[b]=a}),this._isLoading=!1,a.call(this,this._configuration))}};a.prototype._loadGoogleApi=function(b,c){if(!0!==this._googleApiLoaded&&!0!==this._gapiLoading){this._gapiLoading=!0;var e=this;a._gapiLoadedCallback=function(){e._googleApiLoaded=
!0;e._gapiLoading=!1;a._gapiLoadedCallback=null;b.call(e)};var k=function(){e._googleApiLoaded=!1;e._gapiLoading=!1;a._gapiLoadedCallback=null;c.call(e)},m;m=this._configuration.geoMapKey?"https://maps.googleapis.com/maps/api/js?v\x3d3\x26sensor\x3dfalse\x26callback\x3dadf.mf.internal.dvt.geomap.GeographicMapRenderer._gapiLoadedCallback\x26key\x3d"+this._configuration.geoMapKey:this._configuration.geoMapClientId?"https://maps.googleapis.com/maps/api/js?v\x3d3\x26sensor\x3dfalse\x26callback\x3dadf.mf.internal.dvt.geomap.GeographicMapRenderer._gapiLoadedCallback\x26client\x3d"+
this._configuration.geoMapClientId:"https://maps.googleapis.com/maps/api/js?v\x3d3\x26sensor\x3dfalse\x26callback\x3dadf.mf.internal.dvt.geomap.GeographicMapRenderer._gapiLoadedCallback";window.setTimeout(function(){null!==a._gapiLoadedCallback&&k()},3E4);adf.mf.api.resourceFile.loadJsFile(m,!0,function(){},k)}};a.prototype._loadOracleMVApi=function(a,b){if(!0!==this._oracleMVApiLoaded&&!0!==this._omvapiLoading){this._omvapiLoading=!0;var c=this,e=this._configuration.mapViewerUrl;null==e&&(e=DvtGeographicMap.MAP_VIEWER_URL);
var e=e+"/fsmc/jslib/oraclemaps.js",m=function(){c._oracleMVApiLoaded=!1;c._omvapiLoading=!1;b.call(c)},n=300,t=setInterval(function(){void 0!==window.MVMapView&&MVMapView.version?(clearInterval(t),c._oracleMVApiLoaded=!0,c._omvapiLoading=!1,a.call(c)):0===n&&(clearInterval(t),m());n--},100);adf.mf.api.resourceFile.loadJsFile(e,!0,function(){},m)}};adf.mf.internal.dvt.DvtmObject.createPackage("adf.mf.api.dvt");adf.mf.api.dvt.MapBoundsChangeEvent=function(a,b,c,e,m,n,t){this.minX=a;this.minY=b;this.maxX=
c;this.maxY=e;this.centerX=m;this.centerY=n;this.zoomLevel=t;this[".type"]="oracle.adfmf.amx.event.MapBoundsChangeEvent"};adf.mf.api.dvt.MapInputEvent=function(a,b,c){this.type=a;this.pointX=b;this.pointY=c;this[".type"]="oracle.adfmf.amx.event.MapInputEvent"};a.prototype.GetStyleClassesDefinition=function(){var b=a.superclass.GetStyleClassesDefinition.call(this);b._self={path:"background-color",type:adf.mf.internal.dvt.StyleProcessor.BACKGROUND};return b};a.prototype.InitComponentOptions=function(b,
c){a.superclass.InitComponentOptions.call(this,b,c);c.mapOptions={};b._dataObj={dataLayers:[],routes:[],mapOptions:{}}};a.prototype.GetAttributesDefinition=function(){var c=a.superclass.GetAttributesDefinition.call(this);c.mapType={path:"mapOptions/mapType",type:b.TEXT};c.centerX={path:"mapOptions/centerX",type:b.TEXT};c.centerY={path:"mapOptions/centerY",type:b.TEXT};c.zoomLevel={path:"mapOptions/zoomLevel",type:b.TEXT};c.initialZooming={path:"mapOptions/initialZooming",type:b.TEXT,"default":"auto"};
c.animationOnDisplay={path:"mapOptions/animationOnDisplay",type:b.TEXT};c.shortDesc={path:"mapOptions/shortDesc",type:b.TEXT};return c};a.prototype.ProcessAttributes=function(b,c,e){var k=e._descendentChanges;c.getAttribute("__userselection")&&k&&k.getAffectedNodes().forEach(function(a){var b=k.getChanges(a);b&&b.hasChanged("selectedRowKeys")&&(b=c.getAttribute("__userselection"),b[a.getId()]=null,c.setAttributeResolvedValue("__userselection",b))});e=a.superclass.ProcessAttributes.call(this,b,c,e);
var m=this,n=function(a){return a.isAttributeDefined("rendered")&&adf.mf.api.amx.isValueFalse(a.getAttribute("rendered"))?!1:"marker"===a.getTag().getName()},t=function(a,b){for(var c={id:a.getId(),x:a.getAttribute("pointX"),y:a.getAttribute("pointY"),address:a.getAttribute("address"),_rowKey:""+(b+1),displayMarker:!1},d=null,e=a.getChildren(),g=0;g<e.length;g++)if(n.call(e,e[g])){d=e[g];break}if(d){if(d.isAttributeDefined("rendered")&&adf.mf.api.amx.isValueFalse(d.getAttribute("rendered")))return c;
c.displayMarker=!0;m.processGeographicMapDataItem(null,c,d)}return c},u=this.filterArray(c.getChildren(),function(a){return a.isAttributeDefined("rendered")&&adf.mf.api.amx.isValueFalse(a.getAttribute("rendered"))?!1:"route"===a.getTag().getName()});c._dataObj.routes=u.map(function(a){var b={id:a.getId(),style:{"default":{color:a.getAttribute("lineColor"),width:a.getAttribute("lineWidth"),opacity:a.getAttribute("lineOpacity")}},travelMode:a.getAttribute("travelMode"),wayPoints:a.getRenderedChildren().map(t)};
m._hasAction(a)&&(b.action=b.id);return b});b.mapOptions.hasMapInputActionListener=c.isAttributeDefined("mapInputListener");b.mapOptions.hasMapBoundsChangeActionListener=c.isAttributeDefined("mapBoundsChangeListener");return e};a.prototype.ProcessChildren=function(a,b,c){return this.processGeographicMapPointDataLayerTags(c.amxNode,b,!0)};a.prototype.ProcessEvent=function(b,e,h){a.superclass.ProcessEvent.call(this,b,e,h);var k=this;h=e.getType?e.getType():e.type;var m=null;if("selection"===h){h=b.getAttribute("__userselection")||
{};var n=e.getParamValue("dataLayerId");if(n){var m=this.findAmxNode(b,n),t=e.getSelection(),t=t.map(function(a){return a.rowKey});e=this.filterArray(h[n],function(a){return-1===t.indexOf(a)});var u=new adf.mf.api.amx.SelectionEvent(e,t);h[n]=t;b.setAttributeResolvedValue("__userselection",h);adf.mf.api.amx.processAmxEvent(m,"selection",void 0,void 0,u,null)}else{var v=h;h={};b.setAttributeResolvedValue("__userselection",h);Object.keys(v).forEach(function(a){m=k.findAmxNode(b,a);u=new adf.mf.api.amx.SelectionEvent(v[a],
[]);adf.mf.api.amx.processAmxEvent(m,"selection",void 0,void 0,u,null)})}}else if("action"===h){if(m=k.findAmxNode(b,e.getClientId())){if(h=e.getParamValue("pointXY")){n=document.getElementById(m.getId());if(!n){var n=b.getId()+"_canvas",w=document.getElementById(n),n=c.createDIV();c.writeIDAttribute(n,m.getId());c.writeStyleAttribute(n,"position: absolute; width:1px; height:1px;");w.appendChild(n)}n.style.cssText+="top:"+(h.y-2)+"px;left:"+(h.x+1)+"px;"}h=new adf.mf.api.amx.ActionEvent;e=e.getParamValue("actionType")||
"click";n=function(){};"click"===e&&(e="action",n=function(){var a=m.getAttributeExpression("action",!0);null!=a&&adf.mf.api.amx.doNavigation(a)});adf.mf.api.amx.processAmxEvent(m,e,void 0,void 0,h,n)}}else"mapinput"===h&&b.isAttributeDefined("mapInputListener")?(e=new adf.mf.api.dvt.MapInputEvent(e.getEventId(),e.getPointX(),e.getPointY()),adf.mf.api.amx.processAmxEvent(b,"mapInput",void 0,void 0,e)):"mapboundschange"===h&&b.isAttributeDefined("mapBoundsChangeListener")&&(e=new adf.mf.api.dvt.MapBoundsChangeEvent(e.getMinX(),
e.getMinY(),e.getMaxX(),e.getMaxY(),e.getCenterX(),e.getCenterY(),e.getZoomLevel()),adf.mf.api.amx.processAmxEvent(b,"mapBoundsChange",void 0,void 0,e))};a.prototype.CreateComponentInstance=function(a,b){var c=this.CreateComponentCallback(b);c||(c=null);return adf.mf.internal.dvt.geomap.DvtGeographicMap.newInstance(null===c?null:c.callback,c,this.GetDataObject(b))};a.prototype.SetupComponent=function(b){var e=a.superclass.SetupComponent.call(this,b),h=c.createDIV();b=b.getId()+"_canvas";c.writeIDAttribute(h,
b);c.writeStyleAttribute(h,"width: 100%; height: 100%;");e.appendChild(h);adf.mf.environment.profile.dtMode&&(h=document.createElement("div"),h.className="dvtm-readonly",e.appendChild(h));return e};a.prototype._checkAndRenderWarning=function(a,b){switch(a.getAttribute(b)){case "success":return!0;case "failure":return this._renderReloadPage(a,a.getId()+"_canvas"),!1;default:return this._renderPlaceholder(a.getId()+"_canvas"),!1}};a.prototype.postDisplay=function(b,c){this.IsAncestor(document.body,
b)&&this.GetComponentDimensions(b,c);this._checkAndRenderWarning(c,"_configuration")&&(!1===c.getAttribute("_networkAvailable")?this._renderReloadPage(c,c.getId()+"_canvas"):this._checkAndRenderWarning(c,"_apiLoaded")&&(!1===this.__isReadyToRender(c)?this._renderPlaceholder(c.getId()+"_canvas"):a.superclass.postDisplay.call(this,b,c)))};a.prototype.refresh=function(b,c,e){c.hasChanged("inlineStyle")&&document.getElementById(b.getId()).setAttribute("style",b.getAttribute("inlineStyle"));if(!1===b.getAttribute("_networkAvailable"))this._renderReloadPage(b,
b.getId()+"_canvas");else{var k=0;c.hasChanged("centerX")&&k++;c.hasChanged("centerY")&&k++;c.hasChanged("zoomLevel")&&k++;this._checkAndRenderWarning(b,"_apiLoaded")&&(this.__isReadyToRender(b)&&(e||k!==c.getSize())&&a.superclass.refresh.call(this,b,c,e),e=document.getElementById(b.getId()),e=this.GetComponentInstance(e,b),(c.hasChanged("centerX")||c.hasChanged("centerY"))&&e.moveCenter(b.getAttribute("centerX"),b.getAttribute("centerY")),c.hasChanged("zoomLevel")&&e.updateZoomLevel(b.getAttribute("zoomLevel")))}};
a.prototype.__isReadyToRender=function(a){var b=!0;a.visitChildren(new adf.mf.api.amx.VisitContext,function(a,c){if(c.isAttributeDefined("rendered")&&adf.mf.api.amx.isValueFalse(c.getAttribute("rendered")))return adf.mf.api.amx.VisitResult.REJECT;if("pointDataLayer"===c.getTag().getName()){if(c.isAttributeDefined("value")){var d=c.getAttribute("value");if(void 0===d||d&&d.treeNodeBindings&&(d=adf.mf.api.amx.createIterator(d),d.getTotalCount()>d.getAvailableCount()))return b=!1,adf.mf.api.amx.VisitResult.COMPLETE}return adf.mf.api.amx.VisitResult.REJECT}return adf.mf.api.amx.VisitResult.ACCEPT});
return b};a.prototype.RefreshComponent=function(b,c,e){b._dataObj={dataLayers:[],routes:[],mapOptions:{}};b.getAttribute("__userselection")&&e&&e.getAffectedNodes().forEach(function(a){var c=e.getChanges(a);c&&c.hasChanged("selectedRowKeys")&&(c=b.getAttribute("__userselection"),c[a.getId()]=null,b.setAttributeResolvedValue("__userselection",c))});a.superclass.RefreshComponent.call(this,b,c,e)};a.prototype.RenderComponent=function(a,b,c,e){var m=document.getElementById(e.getId()+"_canvas");a.setMapProvider(e.getAttribute("_mapProvider"));
a.setMapViewerUrl(e.getAttribute("_mapViewerUrl"));a.setELocationUrl(e.getAttribute("_eLocationUrl"));a.setProxyUrl(e.getAttribute("_proxyUrl"));a.enableXMLHTTP(e.getAttribute("_enableXMLHTTP"));a.setBaseMap(e.getAttribute("_baseMap"));a.setScreenReaderMode(e.getAttribute("_accessibilityEnabled"));var n=this.GetDataObject(e);a.setOptions(n);a.render(m,e._dataObj,b,c)};a.prototype._renderPlaceholder=function(a){var b=document.getElementById(a);adf.mf.api.amx.emptyHtmlElement(b);var c=document.createElement("div");
c.id=a+"_placeholder";c.className="dvtm-component-placeholder amx-deferred-loading";a=adf.mf.resource.getInfoString("AMXInfoBundle","MSG_LOADING");c.setAttribute("aria-label",a);b.appendChild(c)};a.prototype._renderReloadPage=function(a,b){var c=document.getElementById(b);adf.mf.api.amx.emptyHtmlElement(c);var e=document.createElement("div");e.classList.add("dvtm-geographicMap-loadPage");var m=document.createElement("div"),n=document.createElement("div");n.appendChild(document.createTextNode(adf.mf.resource.getInfoString("AMXInfoBundle",
"dvtm_geographicMap_FAILED_LOAD_API")));m.appendChild(n);var t=document.createElement("div");t.setAttribute("tabindex","0");n=document.createElement("label");n.classList.add("amx-commandButton-label");n.appendChild(document.createTextNode(adf.mf.resource.getInfoString("AMXInfoBundle","dvtm_geographicMap_RELOAD_BUTTON_LABEL")));t.appendChild(n);t.setAttribute("role","button");t.classList.add("amx-node","amx-commandButton");adf.mf.api.amx.addBubbleEventListener(t,"tap",function(c){c=new adf.mf.api.amx.AmxNodeUpdateArguments;
a.setAttributeResolvedValue("_configuration","reload");c.setAffectedAttribute(a,"_configuration");adf.mf.api.amx.emptyHtmlElement(document.getElementById(b));adf.mf.api.amx.markNodeForUpdate(c)});m.appendChild(t);e.appendChild(m);c.appendChild(e);c=null};a.prototype.processGeographicMapPointDataLayerTags=function(a,b,c){c=a._dataObj;b=b.getChildren();for(b=adf.mf.api.amx.createIterator(b);b.hasNext();){var e=b.next();if(!(e.isAttributeDefined("rendered")&&adf.mf.api.amx.isValueFalse(e.getAttribute("rendered"))||
"pointDataLayer"!==e.getTag().getName())){var m={},n=b.getRowKey();m.idx=n;this.processSingleGeographicMapPointDataLayerTag(a,e,m);c.dataLayers.push(m)}}};a.prototype.processSingleGeographicMapPointDataLayerTag=function(a,c,e){var k;(k=c.getAttribute("id"))&&(e.id=k);(k=c.getAttribute("animationOnDuration"))&&(e.animationOnDuration=k);(k=c.getAttribute("animationOnDataChange"))&&(e.animationOnDataChange=k);var m="",n=a.getAttribute("__userselection"),n=n||{},t=n[c.getId()];if(t){for(k=0;k<t.length;k++)k&&
(m+=" "),m+=t[k];e.selectedRowKeys=m}else if(k=c.getAttribute("selectedRowKeys")){if((t=b.ROWKEYARRAY(k))&&0<t.length)for(k=0;k<t.length;k++)k&&(m+=" "),m+=t[k];e.selectedRowKeys=m;n[c.getId()]=t;a.setAttributeResolvedValue("__userselection",n)}(k=c.getAttribute("dataSelection"))&&(e.dataSelection=k);(k=c.getAttribute("emptyText"))&&(e.emptyText=k);this.processGeographicMapPointLocationTag(a,e,c)};a.prototype.processGeographicMapPointLocationTag=function(a,b,c){b.data=[];var e=c.getAttribute("var"),
m=c.getAttribute("value");if(!(adf.mf.environment.profile.dtMode&&m&&-1<m.replace(/\s+/g,"").indexOf("#{")))if(m)for(m=adf.mf.api.amx.createIterator(m);m.hasNext();){var n=m.next(),t=c.getChildren(null,m.getRowKey());adf.mf.el.addVariable(e,n);for(n=adf.mf.api.amx.createIterator(t);n.hasNext();){var t=n.next(),u=m.getRowKey();this._processGeographicMapPointLocation(a,b,t,u)}adf.mf.el.removeVariable(e)}else for(c=c.getChildren(),c=adf.mf.api.amx.createIterator(c);c.hasNext();)e=c.next(),m=""+(c.getRowKey()+
1),this._processGeographicMapPointLocation(a,b,e,m)};a.prototype._processGeographicMapPointLocation=function(a,b,c,e){if(!("pointLocation"!==c.getTag().getName()||c.isAttributeDefined("rendered")&&adf.mf.api.amx.isValueFalse(c.getAttribute("rendered")))){var m={};c.isAttributeDefined("type")&&(m.type=c.getAttribute("type"));c.isAttributeDefined("pointX")&&c.isAttributeDefined("pointY")?(m.x=c.getAttribute("pointX"),m.y=c.getAttribute("pointY")):c.isAttributeDefined("address")&&(m.address=c.getAttribute("address"));
c.isAttributeDefined("id")&&(m.id=c.getAttribute("id"));c=c.getChildren();0<c.length&&"marker"===c[0].getTag().getName()&&(m._rowKey=e,this.processGeographicMapDataItem(a,m,c[0]));b.data.push(m)}};a.prototype.processGeographicMapDataItem=function(a,b,c){c.isAttributeDefined("rendered")&&adf.mf.api.amx.isValueFalse(c.getAttribute("rendered"))||(c.isAttributeDefined("source")&&(b.source=adf.mf.api.amx.buildRelativePath(c.getAttribute("source"))),c.isAttributeDefined("sourceHover")&&(b.sourceHover=adf.mf.api.amx.buildRelativePath(c.getAttribute("sourceHover"))),
c.isAttributeDefined("sourceSelected")&&(b.sourceSelected=adf.mf.api.amx.buildRelativePath(c.getAttribute("sourceSelected"))),c.isAttributeDefined("sourceHoverSelected")&&(b.sourceHoverSelected=adf.mf.api.amx.buildRelativePath(c.getAttribute("sourceHoverSelected"))),c.isAttributeDefined("shortDesc")&&(b.shortDesc=c.getAttribute("shortDesc")),"on"===c.getAttribute("labelDisplay")&&(c.isAttributeDefined("value")&&(b.label=c.getAttribute("value")),c.isAttributeDefined("labelPosition")&&(b.labelPosition=
c.getAttribute("labelPosition")),c.isAttributeDefined("labelStyle")&&(b.labelStyle=c.getAttribute("labelStyle"))),c.isAttributeDefined("width")&&(b.width=+c.getAttribute("width")),c.isAttributeDefined("height")&&(b.height=+c.getAttribute("height")),c.isAttributeDefined("scaleX")&&(b.scaleX=+c.getAttribute("scaleX")),c.isAttributeDefined("scaleY")&&(b.scaleY=+c.getAttribute("scaleY")),c.isAttributeDefined("rotation")&&(b.rotation=+c.getAttribute("rotation")),c.isAttributeDefined("opacity")&&(b.opacity=
+c.getAttribute("opacity")),b.clientId=c.getId(),this._hasAction(c)?b.action=b._rowKey:b.action=null)};a.prototype._hasAction=function(a){if(a.isAttributeDefined("action"))return!0;var b;b=a.getTag().findTags(adf.mf.internal.dvt.AMX_NAMESPACE,"setPropertyListener");if(0<b.length)return!0;b=a.getTag().findTags(adf.mf.internal.dvt.AMX_NAMESPACE,"showPopupBehavior");if(0<b.length)return!0;b=a.getTag().findTags(adf.mf.internal.dvt.AMX_NAMESPACE,"actionListener");return 0<b.length?!0:!1};adf.mf.api.amx.TypeHandler.register(adf.mf.api.amx.AmxTag.NAMESPACE_DVTM,
"geographicMap",a)})();
(function(){function b(){m={}}var c=function(a,b){this.Init(a,b)};adf.mf.internal.dvt.DvtmObject.createSubclass(c,"adf.mf.internal.dvt.DvtmObject","adf.mf.internal.dvt.geomap.DvtGeographicMap");c.MAP_PROVIDER_ORACLE="oraclemaps";c.MAP_PROVIDER_GOOGLE="googlemaps";c.MAP_VIEWER_URL="http://elocation.oracle.com/mapviewer";c.ELOCATION_BASE_URL="http://elocation.oracle.com/elocation";c.BASE_MAP="ELOCATION_MERCATOR.WORLD_MAP";c.prototype.Init=function(a,b){this._callback=a;this._callbackObj=b;this.mapProvider=
c.MAP_PROVIDER_GOOGLE;this.mapViewerUrl=c.MAP_VIEWER_URL;this.eLocationUrl=c.ELOCATION_BASE_URL;this.baseMap=c.BASE_MAP;this.selection=[];this.screenReaderMode=this.initialSelectionApplied=!1};c.newInstance=function(a,b,d){a=new c(a,b);a.setOptions(d);return a};c.prototype.getMapProvider=function(){return this.mapProvider};c.prototype.setMapProvider=function(a){if(a==c.MAP_PROVIDER_ORACLE||a==c.MAP_PROVIDER_GOOGLE)this.mapProvider=a};c.prototype.getMapViewerUrl=function(){return this.mapViewerUrl};
c.prototype.getELocationUrl=function(){return this.eLocationUrl};c.prototype.setMapViewerUrl=function(a){a&&(this.mapViewerUrl=a)};c.prototype.setELocationUrl=function(a){a&&(this.eLocationUrl=a)};c.prototype.setProxyUrl=function(a){a&&(this.proxyUrl=a)};c.prototype.enableXMLHTTP=function(a){this._enableXMLHTTP=!0===a?!0:!1};c.prototype.setMapViewerUrl=function(a){a&&(this.mapViewerUrl=a)};c.prototype.isEnableXMLHTTP=function(){return this._enableXMLHTTP};c.prototype.getProxyUrl=function(){return this.proxyUrl};
c.prototype.getBaseMap=function(){return this.baseMap};c.prototype.setBaseMap=function(a){this.baseMap=a};c.prototype.setOptions=function(a){this.Options=e.calcOptions(a)};c.prototype.getScreenReaderMode=function(){return this.screenReaderMode};c.prototype.setScreenReaderMode=function(a){this.screenReaderMode=a};c.prototype.__dispatchEvent=function(a){this._callback&&this._callback&&this._callback.call&&this._callback.call(this._callbackObj,a,this)};c.prototype.render=function(a,b,c,e){this.Data=
b;this._width=c;this._height=e;d.render(this,a,c,e)};c.prototype.moveCenter=function(a,b){d.moveCenter(this,a,b)};c.prototype.updateZoomLevel=function(a){d.updateZoomLevel(this,a)};var a=function(){};adf.mf.internal.dvt.DvtmObject.createSubclass(a,"adf.mf.internal.dvt.DvtmObject","DvtBaseComponentEvent","PRIVATE");a.CLIENT_ROW_KEY="clientRowKey";a.prototype.Init=function(a){this.type=this._type=a};a.prototype.getType=function(){return this._type};a.prototype.getParamKeys=function(){return this._paramKeys};
a.prototype._getParamValues=function(){return this._paramValues};a.prototype.addParam=function(a,b){this._paramKeys||(this._paramKeys=[],this._paramValues=[]);this._paramKeys.push(a);this._paramValues.push(b)};a.prototype.getParamValue=function(a){if(!a||!this._paramKeys||!this._paramValues)return null;for(var b=-1,c=0;c<this._paramKeys.length;c++)if(this._paramKeys[c]==a){b=c;break}return-1!=b?this._paramValues[b]:null};var e=function(){};adf.mf.internal.dvt.DvtmObject.createSubclass(e,"adf.mf.internal.dvt.DvtmObject",
"DvtGeographicMapDefaults","PRIVATE");e.VERSION_1={mapOptions:{mapType:"ROADMAP",zoomLevel:"14",centerX:"-98.57",centerY:"39.82",doubleClickBehavior:"zoomin"}};e.calcOptions=function(a){var b=e._getDefaults(a);if(!a)return b;var c=a.mapOptions.zoomLevel?!0:!1;a=adf.mf.internal.dvt.util.JSONUtils.mergeObjects(a,b);a.mapOptions.explicitZoom=c;return a};e._getDefaults=function(a){return adf.mf.internal.dvt.util.JSONUtils.cloneObject(e.VERSION_1)};var d=function(){};adf.mf.internal.dvt.DvtmObject.createSubclass(d,
"adf.mf.internal.dvt.DvtmObject","DvtGeographicMapRenderer","PRIVATE");d.DEFAULT_ORACLE_MARKER_IMG="css/images/geomap/ball_ena.png";d.DEFAULT_ORACLE_MARKER_HOVER_IMG="css/images/geomap/ball_ovr.png";d.DEFAULT_ORACLE_MARKER_SELECT_IMG="css/images/geomap/ball_sel.png";d.DEFAULT_GOOGLE_MARKER_IMG="css/images/geomap/red-circle.png";d.DEFAULT_GOOGLE_MARKER_HOVER_IMG="css/images/geomap/ylw-circle.png";d.DEFAULT_GOOGLE_MARKER_SELECT_IMG="css/images/geomap/blu-circle.png";d.MOUSE_OVER="mouseover";d.MOUSE_OUT=
"mouseout";d.CLICK="click";d.SEL_NONE="none";d.SEL_SINGLE="single";d.SEL_MULTIPLE="multiple";d.render=function(a,b,e,g){var h=a.getMapProvider();h===c.MAP_PROVIDER_ORACLE?d.renderOracleMap(a,b,e,g):h===c.MAP_PROVIDER_GOOGLE&&d.renderGoogleMap(a,b,e,g);!0===a.getScreenReaderMode()&&d.renderMarkerText(a,b);a.__dispatchEvent({type:"ready"})};d.renderMarkerText=function(a,b){var c=a.Data,e=a.Options,g="";e.mapOptions.shortDesc&&(g=e.mapOptions.shortDesc+": ");c=c.dataLayers;for(e=0;e<c.length;e++)for(var h=
c[e].data,k=0;k<h.length;k++)g+=d.getTooltip(h[k])+", ";c=g.length;2<=c&&(g=g.substring(0,c-2));c=document.createElement("div");c.innerHTML=g;b.parentNode.appendChild(c)};d.renderOracleMap=function(a,b,c,e){var g=a.Options;c=a.Data;var h=a.getMapViewerUrl(),k=a.getBaseMap(),m=a.getProxyUrl(),n=g.mapOptions.centerX,t=g.mapOptions.centerY;e=g.mapOptions.zoomLevel;var u="recenter",w=!0;d._mapIncludesData(a)?g.mapOptions.initialZooming&&(w="none"==g.mapOptions.initialZooming?!1:!0):w=!1;n=a.center?a.center:
MVSdoGeometry.createPoint(parseFloat(n),parseFloat(t),8307);if(!a._instance||a._lastKey!==h+"/"+k){!0===a.isEnableXMLHTTP()&&m?(MVGlobalVariables.proxyURL=m,MVMapView.enableXMLHTTP(!0)):MVMapView.enableXMLHTTP(!1);a._lastKey=h+"/"+k;a._instance=new MVMapView(b,h);a._instance.addMapTileLayer(new MVBaseMap(k));var v=function(){if(g.mapOptions.hasMapBoundsChangeActionListener){var b=a._instance.getMapWindowBBox(),c=a._instance.getCenter();if(b&&c){var d=a._instance.getZoomLevel();a._instance.transformGeom(b,
8307,null,function(b){var e=b.getMBR();a._instance.transformGeom(c,8307,null,function(b){b=new x(e[0],e[1],e[2],e[3],b.getPointX(),b.getPointY(),d);a.__dispatchEvent(b)})})}}},M=function(b){if(g.mapOptions.hasMapInputActionListener){var c=a._instance.getMouseLocation();a._instance.transformGeom(c,8307,null,function(c){c=new z(b,c.getPointX(),c.getPointY());a.__dispatchEvent(c)})}};a._instance.attachEventListener(MVEvent.RECENTER,function(){g.mapOptions.initialZooming="none";a.center=a._instance.getCenter();
v()});a._instance.attachEventListener(MVEvent.ZOOM_LEVEL_CHANGE,function(b,c){g.mapOptions.initialZooming="none";g.mapOptions.zoomLevel=""+a._instance.getZoomLevel();v()});a._instance.attachEventListener(MVEvent.MOUSE_CLICK,function(){M("click")});a._instance.attachEventListener(MVEvent.MOUSE_DOWN,function(){M("mousedown")});a._instance.attachEventListener(MVEvent.MOUSE_UP,function(){M("mouseup")})}a.initialSelectionApplied=!1;b=a._instance;b.setCenter(n);e&&b.setZoomLevel(parseInt(e));b.removeAllFOIs();
void 0!==g.mapOptions.doubleClickBehavior&&(u=g.mapOptions.doubleClickBehavior);b.setDoubleClickAction(u);b.setTouchBehavior({touchHold:"mouse_over"});d.renderOracleRoutes(a,b,c,w);d.setOracleMapDataLayer(a,b,c,w);b.display()};d.renderOracleRoutes=function(a,b,c,e){if(c.routes&&0!==c.routes.length)if(d.geoCoderAPILoaded){var g=new OracleELocation(a.getELocationUrl()),h=function(c,d){return function(e,g,h){var k=new v(c,null,d);k.addParam("actionType","click");(h=b.getMapWindowBBox().getMBR())&&e&&
(g=Math.floor((e.getPointX()-h[0])*b.getPixelsPerXUnit()),h=Math.floor((h[3]-e.getPointY())*b.getPixelsPerYUnit()),k.addParam("pointXY",{x:g,y:h}),e=b.transformGeom(e,8307,null,function(b){k.addParam("latLng",{lat:b.getPointY(),lng:b.getPointX()});a.__dispatchEvent(k)}))}},k=function(a){return a.address?a.address:{lat:a.y,lon:a.x}},m=function(b){return!0!==b.displayMarker?null:d.getParams(b,a.getMapProvider())},n=c.routes.map(function(a){return a.wayPoints.map(k)}),t=[];c.routes.forEach(function(a){a=
a.style["default"];var b=a.opacity;null==b&&(b=1);b=Math.round(255*b);t.push({render_style:{color:a.color||"#1fb5fb",opacity:b,width:a.width||8},label:"route"})});var u=5E4;g.getDirections(n,function(e,k){(k||[]).forEach(function(k,n){var t=c.routes[n],w=t.wayPoints.map(m),v=t.action,x=t.id;k.subroutes?k.subroutes.forEach(function(a,b){g.attachEventListenerToRoute(a.routeId,MVEvent.MOUSE_CLICK,h(x,v))}):g.attachEventListenerToRoute(k.routeId,MVEvent.MOUSE_CLICK,h(x,v));((e||[])[n]||[]).forEach(function(c,
e){w[e]&&d.addPointFOI(a,b,c,u++,w[e])})})},function(){console.log("fail")},{ignoreGeocodeErrorsForBatchRequests:!0},{mapview:b,zoomToFit:e,removePreviousRoutes:!0,drawMarkers:!1,routeStyles:t})}else n=a.getELocationUrl()+"/jslib/oracleelocation.js",d.loadJS(n,function(){d.geoCoderAPILoaded=!0;d.renderOracleRoutes(a,b,c,e)})};var g=function(a,b){if(a){switch(a.matchCode){case 1:return adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"Exact match. All fields in the input geocode operation matched values in the geocoding data set."),
!0;case 2:return adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"All of the input fields of the geocoding operation match the geocoding data except the street type, prefix, or suffix."),!0;case 3:return adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"All of the input fields of the geocoding operation match except the house or building number. Also the street type, prefix, or suffix may not match as well."),
!0;case 4:return adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"The address does not match, but the city name and postal code do match."),!0;case 10:return adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"The postal code does not match the input geocoding request, but the city name does match."),!0;case 11:return adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",
b,"The postal code matches the data used for geocoding, but the city name does not match."),!0;case 12:return adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"The region is matched, but the postal code and city name are not matched."),!0}a.errorMessage?adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"Geocoder error:"+a.errorMessage):adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",
b,"No matching address found!")}else adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap",b,"No matching address found!");return!1};d.setOracleMapDataLayer=function(a,b,e,h){e=e.dataLayers;for(var k=1E4,m=null,n=null,t=null,u=null,w=0;w<e.length;w++)for(var v=e[w],x=v.data,z=d._getSelectedRowKeys(a,v,w),M=0;M<x.length;M++){var Q=d.getParams(x[M],c.MAP_PROVIDER_ORACLE),O=d.getSelMode(v);Q.selMode=O;Q.dataLayerId=v.id;if(O==d.SEL_SINGLE||O==d.SEL_MULTIPLE)Q.selected=
-1!==z.indexOf(x[M]._rowKey)?!0:!1;if(x[M].x&&x[M].y)d.addPointFOI(a,b,x[M],k++,Q),m=d.getMin(m,parseFloat(x[M].x)),n=d.getMax(n,parseFloat(x[M].x)),t=d.getMin(t,parseFloat(x[M].y)),u=d.getMax(u,parseFloat(x[M].y)),h&&w==e.length-1&&M==x.length-1&&(a.Options.mapOptions.explicitZoom?(Q=MVSdoGeometry.createPoint((m+n)/2,(t+u)/2,8307),b.setCenter(Q)):b.zoomToRectangle(MVSdoGeometry.createRectangle(m,t,n,u,8307)));else if(x[M].address){var O=x[M].address,N=function(c,e){a._jobs=a._jobs?a._jobs+1:1;return function(w){--a._jobs;
w=w[0];g(w,e)&&(d.addPointFOI(a,b,w,k++,c),m=d.getMin(m,parseFloat(w.x)),n=d.getMax(n,parseFloat(w.x)),t=d.getMin(t,parseFloat(w.y)),u=d.getMax(u,parseFloat(w.y)));h&&0===a._jobs&&m&&n&&t&&u&&(delete a._jobs,a.Options.mapOptions.explicitZoom?(w=MVSdoGeometry.createPoint((m+n)/2,(t+u)/2,8307),b.setCenter(w)):b.zoomToRectangle(MVSdoGeometry.createRectangle(m,t,n,u,8307)))}},Y=a.getELocationUrl()+"/jslib/oracleelocation.js",W=function(b,c){return function(){d.geoCoderAPILoaded=!0;(new OracleELocation(a.getELocationUrl())).geocode(b,
N(c,b))}},U=function(){adf.mf.log.Framework.logp(adf.mf.log.level.SEVERE,"adf.mf.internal.dvt.geomap.DvtGeographicMap","setOracleMapDataLayer","Failed to load GeoCoder API!")};d.geoCoderAPILoaded?W(O,Q)():d.loadJS(Y,W(O,Q),U)}}a.initialSelectionApplied=!0};d.addPointFOI=function(a,b,c,e,g){var h=g.action,k=g.selMode,m=g.dataLayerId,t=g.selected,u;u=t?g.sourceSelected:g.source;c=MVSdoGeometry.createPoint(parseFloat(c.x),parseFloat(c.y),8307);var w=MVFOI.createMarkerFOI(e.toString(),c,u);w.enableEventPropagation(!1);
g.tooltip&&w.setInfoTip(g.tooltip);g.opacity&&w.setOpacity(g.opacity);if(g.label){e=-50;"rtl"==document.documentElement.dir&&(e*=-1);e='\x3cspan style\x3d"'+(g.labelStyle||"")+";position:absolute;-webkit-transform: translateX("+e+"%);transform: translateX("+e+'%);white-space:nowrap;"\x3e'+g.label+"\x3c/span\x3e";u=0;switch(g.labelPosition){case "center":u=0;break;case "top":u=-1*Math.floor(g.height/2);break;default:u=Math.floor(g.height/2)}w.setHTMLElement(e,Math.floor(g.width/2),u)}if(k==d.SEL_SINGLE||
k==d.SEL_MULTIPLE)amx.hasTouch()||(d.attachEventListener(a,w,d.MOUSE_OVER,g),d.attachEventListener(a,w,d.MOUSE_OUT,g)),d.attachEventListener(a,w,d.CLICK,g),t&&(k=a.selection[m],void 0===k&&(k=a.selection[m]=[]),w.selected=!0,w.rowKey=g.rowKey,w.dataLayerId=m,k.push(w));h&&n(w,function(a,b,c){w.attachEventListener(MVEvent.MOUSE_DOWN,a);w.attachEventListener(MVEvent.MOUSE_CLICK,b);w.attachEventListener(MVEvent.MOUSE_OUT,c)},function(c){var d=new v(g.clientId,g.rowKey,h);d.addParam("dataLayerId",g.dataLayerId);
d.addParam("actionType",c.data.type);var e=b.getMapWindowBBox().getMBR();c=w.getGeometry();if(e&&c){var k=Math.floor((c.getPointX()-e[0])*b.getPixelsPerXUnit()),e=Math.floor((e[3]-c.getPointY())*b.getPixelsPerYUnit());d.addParam("pointXY",{x:k,y:e});c=b.transformGeom(c,8307,null,function(b){d.addParam("latLng",{lat:b.getPointY(),lng:b.getPointX()});a.__dispatchEvent(d)})}else a.__dispatchEvent(d)});b.removeFOI(w);b.addFOI(w)};d.attachEventListener=function(a,b,c,e){switch(c){case d.MOUSE_OVER:b.attachEventListener(MVEvent.MOUSE_OVER,
function(){b.selected?b.updateImageURL(e.sourceHoverSelected):b.updateImageURL(e.sourceHover)});break;case d.MOUSE_OUT:b.attachEventListener(MVEvent.MOUSE_OUT,function(){b.selected||b.updateImageURL(e.source)});break;case d.CLICK:b.attachEventListener(MVEvent.MOUSE_CLICK,function(){var c=e.dataLayerId,g;a.selection[c]||(a.selection[c]=[]);g=e.selMode;if(b.selected)if(b.updateImageURL(e.source),b.selected=!1,g==d.SEL_SINGLE)a.selection[c]=[];else{if(g==d.SEL_MULTIPLE)for(g=0;g<a.selection[c].length;g++)if(b.getId()==
a.selection[c][g].getId()){a.selection[c].splice(g,1);break}}else{var h=a.selection[c];if(g==d.SEL_SINGLE&&0!=h.length){for(g=0;g<h.length;g++)h[g].updateImageURL(e.source),h[g].selected=!1;a.selection[c]=[]}b.updateImageURL(e.sourceSelected);b.selected=!0;b.rowKey=e.rowKey;b.dataLayerId=c;a.selection[c].push(b)}h=new w(a.selection[c]);h.addParam("dataLayerId",c);a.__dispatchEvent(h)})}};d.renderGoogleMap=function(a,b,c,e){var g=a.Options;c=a.Data;var h="";switch(g.mapOptions.mapType){case "ROADMAP":h=
google.maps.MapTypeId.ROADMAP;break;case "SATELLITE":h=google.maps.MapTypeId.SATELLITE;break;case "HYBRID":h=google.maps.MapTypeId.HYBRID;break;case "TERRAIN":h=google.maps.MapTypeId.TERRAIN;break;default:h=google.maps.MapTypeId.ROADMAP}a.initialSelectionApplied=!1;e=!0;d._mapIncludesData(a)?g.mapOptions.initialZooming&&(e="none"==g.mapOptions.initialZooming?!1:!0):e=!1;var k="none";g.mapOptions.animationOnDisplay&&(k=g.mapOptions.animationOnDisplay);var m;a._firstTime=!1;if(e)a._googlemap||(a._firstTime=
!0,a._googlemap=new google.maps.Map(b)),m=a._googlemap;else{var n=parseFloat(g.mapOptions.centerX),t=parseFloat(g.mapOptions.centerY);if(!a._googlemap){a._firstTime=!0;var u={};u.mapTypeId=h;a._googlemap=new google.maps.Map(b,u)}m=a._googlemap;m.setCenter(new google.maps.LatLng(t,n));m.setZoom(parseInt(g.mapOptions.zoomLevel))}m.setMapTypeId(h);if(a._currentMarkers){for(b=0;b<a._currentMarkers.length;b++)a._currentMarkers[b]&&a._currentMarkers[b].setMap&&a._currentMarkers[b].setMap(null);a._currentMarkers.length=
0}else a._currentMarkers=[];d.googleMapRenderRoutes(a,m,c,e);d.setGoogleMapDataLayer(a,m,c,e,k);google.maps.event.addListenerOnce(m,"idle",function(){var a=m.getCenter();google.maps.event.trigger(m,"resize");m.setCenter(a)})};d.googleMapRenderRoutes=function(a,b,c,e){if(c.routes&&0!==c.routes.length){var g=null,h=0;c.routes.forEach(function(c){if(c.wayPoints&&!(2>c.wayPoints.length)){var k=null,m=c.travelMode;m&&(m=m.toLowerCase());switch(m){case "walking":k=google.maps.TravelMode.WALKING;break;case "cycling":k=
google.maps.TravelMode.BICYCLING;break;default:k=google.maps.TravelMode.DRIVING}var n=c.wayPoints.map(function(a){return a.address?{location:a.address}:{location:new google.maps.LatLng(a.y,a.x)}}),t=c.wayPoints.map(function(b){return!0!==b.displayMarker?null:d.getParams(b,a.getMapProvider())}),m=new google.maps.DirectionsService,k={origin:n[0].location,destination:n[n.length-1].location,travelMode:k,provideRouteAlternatives:!1,waypoints:n.slice(1,n.length-1)},n=c.style["default"],w={strokeColor:n.color||
"#1fb5fb",strokeOpacity:n.opacity||1,strokeWeight:n.width||8},x=c.action,z=c.id;h++;m.route(k,function(c,k){h--;var m=function(c,d){return function(e){var g=new v(c,null,d);e=e.latLng;var h=u(b,e);g.addParam("pointXY",{x:h.x,y:h.y});g.addParam("latLng",{lat:e.lat(),lng:e.lng()});a.__dispatchEvent(g)}};k===google.maps.DirectionsStatus.OK?c.routes.forEach(function(c,k){e&&(g||(g=c.bounds),g=g.union(c.bounds),0===h&&g&&(b.fitBounds(g),g=null));c.legs.forEach(function(e,g){t[g]&&d.processGoogleMapDataPoint(a,
b,e.start_location,t[g],!1,!1);g===c.legs.length-1&&t[g+1]&&d.processGoogleMapDataPoint(a,b,e.end_location,t[g+1],!1,!1);e.steps.forEach(function(c,e){var g=new google.maps.Polyline(w);g.setPath(c.path);x&&google.maps.event.addListener(g,d.CLICK,m(z,x));g.setMap(b);a._currentMarkers=a._currentMarkers||[];a._currentMarkers.push(g)})})}):(adf.mf.log.Framework.logp(adf.mf.log.level.WARNING,"adf.mf.internal.dvt.geomap.DvtGeographicMap","googleMapRenderRoutes","Can't render the route because of the service error."),
adf.mf.log.Framework.logp(adf.mf.log.level.FINE,"adf.mf.internal.dvt.geomap.DvtGeographicMap","googleMapRenderRoutes","Can't render the route because of the service error [returned status: '"+k+"']"))})}})}};var h=null,k=function(){h||(h=function(a,b){this.instance_=a;this.map_=b;this.div_=null;this.setMap(b)},h.prototype=new google.maps.OverlayView,h.prototype.onAdd=function(){var a=document.createElement("div");a.style.border="none";a.style.borderWidth="0px";a.style.position="absolute";a.style.left=
0;a.style.top=0;a.style.right=0;a.style.down=0;this.div_=a;this.getPanes().overlayImage.appendChild(this.div_)},h.prototype.draw=function(){var a=this.getProjection(),b=this.getMap().getBounds(),c=this.div_;c.innerHTML="";this.instance_._currentMarkers.forEach(function(d){if(d.label&&d.getVisible()){var e=d.getPosition();if(b.contains(e)){var e=a.fromLatLngToDivPixel(e),g=document.createElement("span");g.textContent=d.label;d.labelStyle&&g.setAttribute("style",d.labelStyle);g.style.position="absolute";
g.style.whiteSpace="nowrap";g.style.right="auto";g.style.bottom="auto";g.style.width="auto";g.style.height="auto";c.appendChild(g);g.style.left=e.x-g.offsetWidth/2+"px";var h=d.getIcon();switch(d.labelPosition){case "center":g.style.top=e.y-Math.floor((h.size.height+g.offsetHeight)/2)+"px";break;case "top":g.style.top=e.y-Math.floor(h.size.height+g.offsetHeight)-1+"px";break;default:g.style.top=e.y+1+"px"}}}})},h.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_)},h.prototype.hide=
function(){this.div_&&(this.div_.style.visibility="hidden")},h.prototype.show=function(){this.div_&&(this.div_.style.visibility="visible")},h.prototype.toggle=function(){this.div_&&("hidden"===this.div_.style.visibility?this.show():this.hide())},h.prototype.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(this.map_)})};d.googleMapRenderEnd=function(a,b,c){k();for(var e=[],g=0;g<c.length;g++){var m=c[g];m&&(!0===m.resolved?d.processGoogleMapDataPoint(b,a,m.latLng,m.params,m.animation,
m.initialZooming):e.push(m))}if(0<e.length){var n=(new Date).getTime();setTimeout(function(c,d,e){var g=new google.maps.Geocoder,h=window.setInterval(function(){if(0===e.length||3E3<(new Date).getTime()-n){if(clearInterval(h),3E3<(new Date).getTime()-n)throw Error("ERR_DAILY_QUOTA_EXCEEDED");}else{var k=e.shift();if(k){var m=k.address;void 0===d._addresscache&&(d._addresscache={});var t=d._addresscache[m];t?d.processGoogleMapDataPoint(b,a,t,k.params,k.animation,!1):g.geocode({address:m},c(k.params,
m,k.animation))}}},Math.floor(100)+1)},1E3-Math.floor(100)+1,function(c,g,h){return function(k,m){if(m===google.maps.GeocoderStatus.OK){var t=k[0].geometry.location;d._addresscache[g]=t;n=(new Date).getTime();d.processGoogleMapDataPoint(b,a,t,c,h,!1)}m===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&e.push({resolved:!1,address:g,params:c,animation:h,initialZooming:!1})}},d,e)}b.initialSelectionApplied=!0;b._bounds?(c=parseInt(b.Options.mapOptions.zoomLevel),g=b._bounds.getNorthEast(),m=b._bounds.getSouthWest(),
g.equals(m)?d.zoomToMarker(a,g,c):b.Options.mapOptions.explicitZoom?(g=b._bounds.getCenter(),d.zoomToMarker(a,g,c)):a.fitBounds(b._bounds),b._bounds=null):a.getZoom()||(c=parseFloat(b.Options.mapOptions.centerY),g=parseFloat(b.Options.mapOptions.centerX),g=new google.maps.LatLng(c,g),d.zoomToMarker(a,g,2));if(b._firstTime){b.textOverlay=new h(b,a);var t=function(){if(b.Options.mapOptions.hasMapBoundsChangeActionListener){var c=a.getBounds(),d=a.getZoom();c&&(c=new x(c.getSouthWest().lng(),c.getSouthWest().lat(),
c.getNorthEast().lng(),c.getNorthEast().lat(),c.getCenter().lng(),c.getCenter().lat(),d),b.__dispatchEvent(c))}};google.maps.event.addListener(a,"dragend",function(){var c=b.Options,d=a.getCenter();d&&(c.mapOptions.centerX=""+d.lng(),c.mapOptions.centerY=""+d.lat());var e=a.getZoom();e&&(c.mapOptions.zoomLevel=""+e);if(e||d)c.mapOptions.initialZooming="none";t()});google.maps.event.addListener(a,"maptypeid_changed",function(){var c=b.Options;switch(a.getMapTypeId()){case google.maps.MapTypeId.ROADMAP:c.mapOptions.mapType=
"ROADMAP";break;case google.maps.MapTypeId.SATELLITE:c.mapOptions.mapType="SATELLITE";break;case google.maps.MapTypeId.HYBRID:c.mapOptions.mapType="HYBRID";break;case google.maps.MapTypeId.TERRAIN:c.mapOptions.mapType="TERRAIN";break;default:c.mapOptions.mapType="ROADMAP"}});var u=null,w=function(a){u&&(a=new z(a,u.lng(),u.lat()),b.__dispatchEvent(a))};b.Options.mapOptions.hasMapInputActionListener&&(google.maps.event.addListener(a,"click",function(a){a=a.latLng;a=new z("click",a.lng(),a.lat());b.__dispatchEvent(a)}),
google.maps.event.addListener(a,"mousemove",function(a){u=a.latLng}),google.maps.event.addDomListener(a.getDiv(),"mousedown",function(a){w("mousedown")}),google.maps.event.addDomListener(a.getDiv(),"mouseup",function(a){w("mouseup")}));google.maps.event.addListener(a,"zoom_changed",t)}};d.processGoogleMapDataPoint=function(a,b,c,e,g,h){d.addMarker(a,b,c,e,g);h&&(a._bounds||(a._bounds=new google.maps.LatLngBounds(c,c)),a._bounds=a._bounds.extend(c))};var m={},n=function(a,c,d,e){e=e||{};var g=null;
c.call(this,function(b){g=amx.uuid();m[g]=(new Date).getTime();setTimeout(function(){if(0<m[g]){delete m[g];var c=b.data;b.data=e;b.data.type="tapHold";d.call(a,b);b.data=c}},800)},function(b){if(m[g]){delete m[g];var c=b.data;b.data=e;b.data.type="click";d.call(a,b);b.data=c}},b)};d.setGoogleMapDataLayer=function(a,b,c,e,g){a._bounds=null;c=c.dataLayers;a._jobCount=0;for(var h=[],k=0,m=void 0,n=0,t=0;t<c.length;t++){var u=c[t],w=u.data,v=d._getSelectedRowKeys(a,u,t);a._jobCount+=w.length;h.length+=
w.length;for(var x=0;x<w.length;x++){var z=d.getParams(w[x],a.getMapProvider()),O=d.getSelMode(u);z.selMode=O;z.dataLayerId=u.id;if(O==d.SEL_SINGLE||O==d.SEL_MULTIPLE)z.selected=-1!==v.indexOf(w[x]._rowKey)?!0:!1;if(w[x].x&&w[x].y)O=new google.maps.LatLng(parseFloat(w[x].y),parseFloat(w[x].x)),h[k]={resolved:!0,latLng:O,params:z,animation:g,initialZooming:e},a._jobCount--;else if(w[x].address){O=w[x].address;void 0===d._addresscache&&(d._addresscache={});var N=d._addresscache[O];N?(h[k]={resolved:!0,
address:O,latLng:N,params:z,animation:g,initialZooming:e},a._jobCount--):(N=function(a,c,k,m){return function(n,t){a._jobCount--;if(t==google.maps.GeocoderStatus.OK){var u=n[0].geometry.location;d._addresscache[m]=u;h[k]={resolved:!0,address:m,latLng:u,params:c,animation:g,initialZooming:e}}t==google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&(h[k]={resolved:!1,address:m,params:c,animation:g,initialZooming:e});0===a._jobCount&&d.googleMapRenderEnd(b,a,h)}},void 0===m&&(m=new google.maps.Geocoder),10>n?
(n++,m.geocode({address:O},N(a,z,k,O))):(a._jobCount--,h[k]={resolved:!1,address:O,params:z,animation:g,initialZooming:e}))}k++}}0===a._jobCount&&d.googleMapRenderEnd(b,a,h)};var t=function(a,b){var c=new google.maps.Size(b.width*b.scaleX,b.height*b.scaleY);return{url:a,size:c,scaledSize:c}};d.addMarker=function(a,b,c,e,g){void 0===a._currentMarkers&&(a._currentMarkers=[]);var h=e.selMode,k=e.dataLayerId,m=e.selected,w=e.action,x="";e.tooltip&&(x=e.tooltip);var z;z=m?t(e.sourceSelected,e):t(e.source,
e);var E=new google.maps.Marker({opacity:e.opacity,position:c,optimized:!(amx&&!0===amx.testmode),icon:z,title:x});E.label=e.label;E.labelStyle=e.labelStyle;E.labelPosition=e.labelPosition;"auto"==g&&E.setAnimation(google.maps.Animation.DROP);E.setMap(b);a._currentMarkers.push(E);if(h==d.SEL_SINGLE||h==d.SEL_MULTIPLE)amx.hasTouch()||(d.attachGMapEventListener(a,E,d.MOUSE_OVER,e),d.attachGMapEventListener(a,E,d.MOUSE_OUT,e)),d.attachGMapEventListener(a,E,d.CLICK,e),m&&(c=a.selection[k],void 0===c&&
(c=a.selection[k]=[]),E.selected=!0,E.rowKey=e.rowKey,E.dataLayerId=k,c.push(E));w&&n(E,function(a,b,c){google.maps.event.addListener(E,"mousedown",a);google.maps.event.addListener(E,"mouseup",b);google.maps.event.addListener(E,"mouseout",c)},function(c){var d=new v(e.clientId,e.rowKey,w);d.addParam("dataLayerId",e.dataLayerId);d.addParam("actionType",c.data.type);c=E.getPosition();var g=u(b,c);d.addParam("pointXY",{x:g.x,y:g.y});d.addParam("latLng",{lat:c.lat(),lng:c.lng()});a.__dispatchEvent(d)})};
var u=function(a,b){var c=Math.pow(2,a.getZoom()),d=a.getProjection(),e=a.getBounds(),e=d.fromLatLngToPoint(new google.maps.LatLng(e.getNorthEast().lat(),e.getSouthWest().lng())),d=d.fromLatLngToPoint(b);return new google.maps.Point(Math.floor((d.x-e.x)*c),Math.floor((d.y-e.y)*c))};d.attachGMapEventListener=function(a,b,c,e){switch(c){case d.MOUSE_OVER:google.maps.event.addListener(b,d.MOUSE_OVER,function(){b.selected?b.setIcon(t(e.sourceHoverSelected,e)):b.setIcon(t(e.sourceHover,e))});break;case d.MOUSE_OUT:google.maps.event.addListener(b,
d.MOUSE_OUT,function(){b.selected||b.setIcon(t(e.source,e))});break;case d.CLICK:google.maps.event.addListener(b,d.CLICK,function(){var c=e.dataLayerId,g;a.selection[c]||(a.selection[c]=[]);g=e.selMode;if(b.selected)if(b.setIcon(t(e.source,e)),b.selected=!1,g==d.SEL_SINGLE)a.selection[c]=[];else{if(g==d.SEL_MULTIPLE)for(g=0;g<a.selection[c].length;g++)if(b.rowKey==a.selection[c][g].rowKey&&b.dataLayerId==a.selection[c][g].dataLayerId){a.selection[c].splice(g,1);break}}else{var h=a.selection[c];if(g==
d.SEL_SINGLE&&0!=h.length){for(g=0;g<h.length;g++)h[g].setIcon(t(e.source,e)),h[g].selected=!1;a.selection[c]=[]}b.setIcon(t(e.sourceSelected,e));b.selected=!0;b.rowKey=e.rowKey;b.dataLayerId=c;a.selection[c].push(b)}h=new w(a.selection[c]);h.addParam("dataLayerId",c);a.__dispatchEvent(h)})}};d.zoomToMarker=function(a,b,c){a.setCenter(b);c&&a.setZoom(c)};d.getParams=function(a,b){var c=d.getTooltip(a),e=d.getSource(a,b),g=d.getSourceHover(a,b),h=d.getSourceSelected(a,b),k=d.getSourceHoverSelected(a,
b),m=a._rowKey,n=a.clientId,t={};t.label=a.label;t.labelPosition=a.labelPosition;t.labelStyle=a.labelStyle;t.width=a.width||32;t.height=a.height||32;t.scaleX=a.scaleX||1;t.scaleY=a.scaleY||1;t.rotation=a.rotation||0;t.opacity=a.opacity||1;t.source=e;t.sourceHover=g;t.sourceSelected=h;t.sourceHoverSelected=k;t.tooltip=c;a.action&&(t.action=a.action);t.rowKey=m;t.clientId=n;return t};d.getSelMode=function(a){var b=d.SEL_NONE;a.dataSelection&&(b=a.dataSelection);return b};d.getTooltip=function(a){var b=
null;a.shortDesc&&(b=a.shortDesc);return b};d.getSource=function(a,b){var e;a.source?e=a.source:b==c.MAP_PROVIDER_ORACLE?e=d.DEFAULT_ORACLE_MARKER_IMG:b==c.MAP_PROVIDER_GOOGLE&&(e=d.DEFAULT_GOOGLE_MARKER_IMG);return e};d.getSourceSelected=function(a,b){var e;a.sourceSelected?e=a.sourceSelected:b==c.MAP_PROVIDER_ORACLE?e=d.DEFAULT_ORACLE_MARKER_SELECT_IMG:b==c.MAP_PROVIDER_GOOGLE&&(e=d.DEFAULT_GOOGLE_MARKER_SELECT_IMG);return e};d.getSourceHover=function(a,b){var e;a.sourceHover?e=a.sourceHover:b==
c.MAP_PROVIDER_ORACLE?e=d.DEFAULT_ORACLE_MARKER_HOVER_IMG:b==c.MAP_PROVIDER_GOOGLE&&(e=d.DEFAULT_GOOGLE_MARKER_HOVER_IMG);return e};d.getSourceHoverSelected=function(a,b){var e;a.sourceHoverSelected?e=a.sourceHoverSelected:b==c.MAP_PROVIDER_ORACLE?e=d.DEFAULT_ORACLE_MARKER_SELECT_IMG:b==c.MAP_PROVIDER_GOOGLE&&(e=d.DEFAULT_GOOGLE_MARKER_SELECT_IMG);return e};d.getMin=function(a,b){if(null==a||a>b)a=b;return a};d.getMax=function(a,b){if(null==a||a<b)a=b;return a};d._getSelectedRowKeys=function(a,b,
c){var e=d.getSelMode(b),g=[];if(e===d.SEL_SINGLE||e===d.SEL_MULTIPLE)if(a.initialSelectionApplied){if(a=a.selection[c]){for(b=0;b<a.length;b++)g.push(a[b].rowKey);a.length=0}}else void 0!==b.selectedRowKeys&&(g=b.selectedRowKeys.split(" "));return g};d._mapIncludesData=function(a){return(a=a.Data)&&a.routes&&0<a.routes.length?!0:a&&a.dataLayers&&0!=a.dataLayers.length?!0:!1};d.loadJS=function(a,b,c){var d=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript";
e.src=a;e.async=!1;e.onload=b;e.onerror=c;d.appendChild(e)};d.moveCenter=function(a,b,d){var e=a.getMapProvider();b=parseFloat(b);d=parseFloat(d);if(e===c.MAP_PROVIDER_ORACLE){if(a=a._instance)b=MVSdoGeometry.createPoint(b,d,8307),a.setCenter(b)}else e===c.MAP_PROVIDER_GOOGLE&&(a=a._googlemap)&&a.setCenter(new google.maps.LatLng(d,b))};d.updateZoomLevel=function(a,b){var d=a.getMapProvider(),e=parseInt(b);d===c.MAP_PROVIDER_ORACLE?(d=a._instance)&&d.setZoomLevel(e):d===c.MAP_PROVIDER_GOOGLE&&(d=a._googlemap)&&
d.setZoom(e)};var v=function(a,b,c){this.Init(v.TYPE);this._clientId=a;this._rowKey=b;this._action=c};adf.mf.internal.dvt.DvtmObject.createSubclass(v,a,"DvtMapActionEvent","PRIVATE");v.TYPE="action";v.prototype.getClientId=function(){return this._clientId};var w=function(a){this.Init(a)};adf.mf.internal.dvt.DvtmObject.createSubclass(w,a,"DvtGeoMapSelectionEvent");w.TYPE="selection";w.prototype.Init=function(a,b){w.superclass.Init.call(this,b?b:w.TYPE);this._selection=a};w.prototype.getSelection=function(){return this._selection};
v.prototype.getRowKey=function(){return this._rowKey};v.prototype.getAction=function(){return this._action};var x=function(a,b,c,d,e,g,h){this.Init(x.TYPE);this._minX=a;this._minY=b;this._maxX=c;this._maxY=d;this._centerX=e;this._centerY=g;this._zoomLevel=h};adf.mf.internal.dvt.DvtmObject.createSubclass(x,a,"DvtMapBoundsChangeEvent","PRIVATE");x.TYPE="mapboundschange";x.prototype.getMinX=function(){return this._minX};x.prototype.getMinY=function(){return this._minY};x.prototype.getMaxX=function(){return this._maxX};
x.prototype.getMaxY=function(){return this._maxY};x.prototype.getCenterX=function(){return this._centerX};x.prototype.getCenterY=function(){return this._centerY};x.prototype.getZoomLevel=function(){return this._zoomLevel};var z=function(a,b,c){this.Init(z.TYPE);this._eventId=a;this._pointX=b;this._pointY=c};adf.mf.internal.dvt.DvtmObject.createSubclass(z,a,"DvtMapInputEvent","PRIVATE");z.TYPE="mapinput";z.prototype.getEventId=function(){return this._eventId};z.prototype.getPointX=function(){return this._pointX};
z.prototype.getPointY=function(){return this._pointY}})();